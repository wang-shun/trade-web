<?xml version="1.0" encoding="UTF-8"?>
<querys>
	<dicts>
	<customDict id="qqcdOrgIdName" beanName="qqcdOrgIdName"></customDict>
	</dicts>
    <formatters>
	</formatters>
	<query id="queryWeeklyBaseInfoList1" cacheResult="true">
	    <searchCondition>        
        </searchCondition>
		<searchSql>
			<baseSql>
				<![CDATA[
				select
				week.CASE_ORG_ID_F ORG_ID,
				
				sum(case when week.CASE_REC_STATUS = 1 and cast(convert(varchar(8) , week.TRANSFER_APP_PASS_TIME, 112 ) as int) between #startWeekDay# and 
				#endWeekDay# then 1 else 0 end) LOSE_NUM_WEEK,
				
				sum(case when week.CASE_REC_STATUS = 0 and cast(convert(varchar(8) , week.TRANSFER_APP_PASS_TIME, 112 ) as int) between #startWeekDay# and 
				#endWeekDay# then 1 else 0 end) REC_NUM_WEEK,
				
				sum(case when cast(convert(varchar(8) , week.TRANSFER_APP_PASS_TIME, 112 ) as int) between #startWeekDay# and 
				#endWeekDay# then 1 else 0 end) TOTAL_NUM_WEEK,
				
				isnull(sum(case when week.CASE_REC_STATUS = 1 and cast(convert(varchar(8) , week.TRANSFER_APP_PASS_TIME, 112 ) as int) between #startWeekDay# and 
				#endWeekDay# then week.MORT_TOTAL_AMOUNT else 0 end),0) LOSE_AMOUNT_WEEK,
				
				isnull(sum(case when week.CASE_REC_STATUS = 0 and cast(convert(varchar(8) , week.TRANSFER_APP_PASS_TIME, 112 ) as int) between #startWeekDay# and 
				#endWeekDay# then week.MORT_TOTAL_AMOUNT else 0 end),0) REC_AMOUNT_WEEK,
				
				isnull(sum(case when cast(convert(varchar(8) , week.TRANSFER_APP_PASS_TIME, 112 ) as int) between #startWeekDay# and 
				#endWeekDay# then week.MORT_TOTAL_AMOUNT else 0 end),0) TOTAL_AMOUNT_WEEK,
				
				case when 
		        #startWeekDay#/100 = #endWeekDay#/100 then (select count(1) from sctrans.T_RPT_WEEKLY_CASE_BASE_INFO a where a.CASE_REC_STATUS = 1 and a.BELONG_WEEK_END_DAY/100 = #belongEndWeekDay#/100 and cast(convert(varchar(8) , a.TRANSFER_APP_PASS_TIME, 112 ) as int) between #endWeekDay#/100*100+1 and 
				#endWeekDay# and a.MORT_TYPE in ('30016001','30016002') and a.TRANSFER_ISPASS = 1 and a.CASE_ORG_ID_F = week.CASE_ORG_ID_F)
				else 
		        (select count(1) from sctrans.T_RPT_WEEKLY_CASE_BASE_INFO b where b.CASE_REC_STATUS = 1 and b.BELONG_WEEK_END_DAY/100 = #belongEndWeekDay#/100 and cast(convert(varchar(8) , b.TRANSFER_APP_PASS_TIME, 112 ) as int) between #lastMonthStartDay# and 
				#lastMonthEndDay# and b.MORT_TYPE in ('30016001','30016002') and b.TRANSFER_ISPASS = 1 and b.CASE_ORG_ID_F = week.CASE_ORG_ID_F)
				end
        		LOSE_NUM_MONTH,
				
        		case when
        		#startWeekDay#/100 = #endWeekDay#/100 then (select count(1) from sctrans.T_RPT_WEEKLY_CASE_BASE_INFO c where c.BELONG_WEEK_END_DAY/100 = #belongEndWeekDay#/100 and cast(convert(varchar(8) , c.TRANSFER_APP_PASS_TIME, 112 ) as int) between #endWeekDay#/100*100+1 and 
				#endWeekDay# and c.MORT_TYPE in ('30016001','30016002') and c.TRANSFER_ISPASS = 1 and c.CASE_ORG_ID_F = week.CASE_ORG_ID_F)
				else 
        		(select count(1) from sctrans.T_RPT_WEEKLY_CASE_BASE_INFO d where d.BELONG_WEEK_END_DAY/100 = #belongEndWeekDay#/100 and cast(convert(varchar(8) , d.TRANSFER_APP_PASS_TIME, 112 ) as int) between #lastMonthStartDay# and 
				#lastMonthEndDay# and d.MORT_TYPE in ('30016001','30016002') and d.TRANSFER_ISPASS = 1 and d.CASE_ORG_ID_F = week.CASE_ORG_ID_F)
                end
				TOTAL_NUM_MONTH,
								
				case when 
        		#startWeekDay#/100 = #endWeekDay#/100 then (select isnull(sum(e.MORT_TOTAL_AMOUNT),0) from sctrans.T_RPT_WEEKLY_CASE_BASE_INFO e where e.CASE_REC_STATUS = 1 and e.BELONG_WEEK_END_DAY/100 = #belongEndWeekDay#/100 and cast(convert(varchar(8) , e.TRANSFER_APP_PASS_TIME, 112 ) as int) between #endWeekDay#/100*100+1 and 
				#endWeekDay# and e.MORT_TYPE in ('30016001','30016002') and e.TRANSFER_ISPASS = 1 and e.CASE_ORG_ID_F = week.CASE_ORG_ID_F) 
				else 
        		(select isnull(sum(f.MORT_TOTAL_AMOUNT),0) from sctrans.T_RPT_WEEKLY_CASE_BASE_INFO f where f.CASE_REC_STATUS = 1 and f.BELONG_WEEK_END_DAY/100 = #belongEndWeekDay#/100 and cast(convert(varchar(8) , f.TRANSFER_APP_PASS_TIME, 112 ) as int) between #lastMonthStartDay# and 
				#lastMonthEndDay# and f.MORT_TYPE in ('30016001','30016002') and f.TRANSFER_ISPASS = 1 and f.CASE_ORG_ID_F = week.CASE_ORG_ID_F)
                end 
				LOSE_AMOUNT_MONTH,
				
				case when 
        		#startWeekDay#/100 = #endWeekDay#/100 then (select isnull(sum(g.MORT_TOTAL_AMOUNT),0) from sctrans.T_RPT_WEEKLY_CASE_BASE_INFO g where g.BELONG_WEEK_END_DAY/100 = #belongEndWeekDay#/100 and cast(convert(varchar(8) , g.TRANSFER_APP_PASS_TIME, 112 ) as int) between #endWeekDay#/100*100+1 and 
				#endWeekDay# and g.MORT_TYPE in ('30016001','30016002') and g.TRANSFER_ISPASS = 1 and g.CASE_ORG_ID_F = week.CASE_ORG_ID_F)
				else         		
        		(select isnull(sum(h.MORT_TOTAL_AMOUNT),0) from sctrans.T_RPT_WEEKLY_CASE_BASE_INFO h where h.BELONG_WEEK_END_DAY/100 = #belongEndWeekDay#/100 and cast(convert(varchar(8) , h.TRANSFER_APP_PASS_TIME, 112 ) as int) between #lastMonthStartDay# and 
				#lastMonthEndDay# and h.MORT_TYPE in ('30016001','30016002') and h.TRANSFER_ISPASS = 1 and h.CASE_ORG_ID_F = week.CASE_ORG_ID_F)
				end 
				TOTAL_AMOUNT_MONTH
				
				from sctrans.T_RPT_WEEKLY_CASE_BASE_INFO week where week.MORT_TYPE in ('30016001','30016002') and week.TRANSFER_ISPASS = 1 and week.BELONG_WEEK_END_DAY = #belongEndWeekDay#
	            ]]>
			</baseSql>
			<orderBySql>
			</orderBySql>
			<groupSql>
			group by week.CASE_ORG_ID_F
			</groupSql>
		</searchSql>
		<grid>
			<table-row>
			    <column type="both" name="ORG_ID" index="" checkbox="" title="组织ID" customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>
			    <column type="virtual" name="ORG_NAME" index="" checkbox="" display="组织名称" customDict="qqcdOrgIdName" referencecol="ORG_ID"/>
			    <column type="both" name="LOSE_NUM_WEEK" index="" checkbox="" title="流失单数(周)" customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>
			    <column type="both" name="REC_NUM_WEEK" index="" checkbox="" title="收单数(周)" customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>
			    <column type="both" name="TOTAL_NUM_WEEK" index="" checkbox="" title="总单数(周)" customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>
			    <column type="both" name="LOSE_AMOUNT_WEEK" index="" checkbox="" title="流失金额(周)" customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>
			    <column type="both" name="REC_AMOUNT_WEEK" index="" checkbox="" title="收单金额(周)" customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>
			    <column type="both" name="TOTAL_AMOUNT_WEEK" index="" checkbox="" title="总金额(周)" customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>
			    <column type="both" name="LOSE_NUM_MONTH" index="" checkbox="" title="流失单数(本月)" customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>
			    <column type="both" name="TOTAL_NUM_MONTH" index="" checkbox="" title="总单数(本月)" customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>
			    <column type="both" name="LOSE_NUM_LAST_MONTH" index="" checkbox="" title="流失单数(上月)" customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>
			    <column type="both" name="TOTAL_NUM_LAST_MONTH" index="" checkbox="" title="总单数(上月)" customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>
			    <column type="both" name="LOSE_AMOUNT_MONTH" index="" checkbox="" title="流失金额(月)" customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>
			    <column type="both" name="TOTAL_AMOUNT_MONTH" index="" checkbox="" title="总金额(月)" customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>
			</table-row>
		</grid>
	</query>
	
	<query id="queryWeeklyBaseInfoList2" cacheResult="true">
	    <searchCondition>        
        </searchCondition>
		<searchSql>
			<baseSql>
				<![CDATA[
				select 
				week.CASE_ORG_ID_F ORG_ID,
				
				sum(case when cast(convert(varchar(8) , week.TRANSFER_APP_PASS_TIME, 112 ) as int) between #startWeekDay# and 
				#endWeekDay# then 1 else 0 end) REC_NUM_WEEK,
				
				sum(case when cast(convert(varchar(8) , week.TRANSFER_APP_PASS_TIME, 112 ) as int) between #startWeekDay# and 
				#endWeekDay# and week.EVA_EVAL_FEE is not null then 1 else 0 end) EVA_NUM_WEEK,
				
				case when 
		        #startWeekDay#/100 = #endWeekDay#/100 then (select sum(case when a.BELONG_WEEK_END_DAY/100 = #belongEndWeekDay#/100 and cast(convert(varchar(8) , a.TRANSFER_APP_PASS_TIME, 112 ) as int) between #endWeekDay#/100*100+1 and 
				#endWeekDay# then 1 else 0 end) from sctrans.T_RPT_WEEKLY_CASE_BASE_INFO a where a.MORT_TYPE in ('30016001','30016002') and a.TRANSFER_ISPASS = 1 and a.CASE_REC_STATUS = 0 and a.CASE_ORG_ID_F = week.CASE_ORG_ID_F)
				else 		        
		        (select sum(case when b.BELONG_WEEK_END_DAY/100 = #belongEndWeekDay#/100 and cast(convert(varchar(8) , b.TRANSFER_APP_PASS_TIME, 112 ) as int) between #lastMonthStartDay# and 
				#lastMonthEndDay# then 1 else 0 end) from sctrans.T_RPT_WEEKLY_CASE_BASE_INFO b where b.MORT_TYPE in ('30016001','30016002') and b.TRANSFER_ISPASS = 1 and b.CASE_REC_STATUS = 0 and b.CASE_ORG_ID_F = week.CASE_ORG_ID_F) 
				end 
		        REC_NUM_MONTH,
						
		        case when 
		        #startWeekDay#/100 = #endWeekDay#/100 then (select sum(case when c.BELONG_WEEK_END_DAY/100 = #belongEndWeekDay#/100 and c.EVA_EVAL_FEE is not null and cast(convert(varchar(8) , c.TRANSFER_APP_PASS_TIME, 112 ) as int) between #endWeekDay#/100*100+1 and 
				#endWeekDay# then 1 else 0 end) from sctrans.T_RPT_WEEKLY_CASE_BASE_INFO c where c.MORT_TYPE in ('30016001','30016002') and c.TRANSFER_ISPASS = 1 and c.CASE_REC_STATUS = 0 and c.CASE_ORG_ID_F = week.CASE_ORG_ID_F) 
				else 		        
		        (select sum(case when d.BELONG_WEEK_END_DAY/100 = #belongEndWeekDay#/100 and d.EVA_EVAL_FEE is not null and cast(convert(varchar(8) , d.TRANSFER_APP_PASS_TIME, 112 ) as int) between #lastMonthStartDay# and 
				#lastMonthEndDay# then 1 else 0 end) from sctrans.T_RPT_WEEKLY_CASE_BASE_INFO d where d.MORT_TYPE in ('30016001','30016002') and d.TRANSFER_ISPASS = 1 and d.CASE_REC_STATUS = 0 and d.CASE_ORG_ID_F = week.CASE_ORG_ID_F) 
				end
				EVA_NUM_MONTH,
						
				isnull(sum(case when cast(convert(varchar(8) , week.TRANSFER_APP_PASS_TIME, 112 ) as int) between #startWeekDay# and 
				#endWeekDay# then week.MORT_COM_AMOUNT*0.001 else 0 end),0) 
				EVA_AMOUNT_WEEK,
						
				isnull(sum(case when cast(convert(varchar(8) , week.TRANSFER_APP_PASS_TIME, 112 ) as int) between #startWeekDay# and 
				#endWeekDay# then week.EVA_EVAL_FEE else 0 end),0) 
				EVA_ACT_AMOUNT_WEEK,
		
		        case when 
		        #startWeekDay#/100 = #endWeekDay#/100 then (select isnull(sum(case when e.BELONG_WEEK_END_DAY/100 = #belongEndWeekDay#/100 and e.EVA_EVAL_FEE is not null and cast(convert(varchar(8) , e.TRANSFER_APP_PASS_TIME, 112 ) as int) between #endWeekDay#/100*100+1 and 
				#endWeekDay# then e.MORT_COM_AMOUNT*0.001 else 0 end),0) from sctrans.T_RPT_WEEKLY_CASE_BASE_INFO e where e.MORT_TYPE in ('30016001','30016002') and e.TRANSFER_ISPASS = 1 and e.CASE_REC_STATUS = 0 and e.CASE_ORG_ID_F = week.CASE_ORG_ID_F) 
				else 		        
		        (select isnull(sum(case when f.BELONG_WEEK_END_DAY/100 = #belongEndWeekDay#/100 and f.EVA_EVAL_FEE is not null and cast(convert(varchar(8) , f.TRANSFER_APP_PASS_TIME, 112 ) as int) between #lastMonthStartDay# and 
				#lastMonthEndDay# then f.MORT_COM_AMOUNT*0.001 else 0 end),0) from sctrans.T_RPT_WEEKLY_CASE_BASE_INFO f where f.MORT_TYPE in ('30016001','30016002') and f.TRANSFER_ISPASS = 1 and f.CASE_REC_STATUS = 0 and f.CASE_ORG_ID_F = week.CASE_ORG_ID_F) 
				end 
				EVA_AMOUNT_MONTH,
						
		        case when 
		        #startWeekDay#/100 = #endWeekDay#/100 then (select isnull(sum(case when g.BELONG_WEEK_END_DAY/100 = #belongEndWeekDay#/100 and g.EVA_EVAL_FEE is not null and cast(convert(varchar(8) , g.TRANSFER_APP_PASS_TIME, 112 ) as int) between #endWeekDay#/100*100+1 and 
				#endWeekDay# then g.EVA_EVAL_FEE else 0 end),0) from sctrans.T_RPT_WEEKLY_CASE_BASE_INFO g where g.MORT_TYPE in ('30016001','30016002') and g.TRANSFER_ISPASS = 1 and g.CASE_REC_STATUS = 0 and g.CASE_ORG_ID_F = week.CASE_ORG_ID_F) 
				else 		        
		        (select isnull(sum(case when h.BELONG_WEEK_END_DAY/100 = #belongEndWeekDay#/100 and h.EVA_EVAL_FEE is not null and cast(convert(varchar(8) , h.TRANSFER_APP_PASS_TIME, 112 ) as int) between #lastMonthStartDay# and 
				#lastMonthEndDay# then h.EVA_EVAL_FEE else 0 end),0) from sctrans.T_RPT_WEEKLY_CASE_BASE_INFO h where h.MORT_TYPE in ('30016001','30016002') and h.TRANSFER_ISPASS = 1 and h.CASE_REC_STATUS = 0 and h.CASE_ORG_ID_F = week.CASE_ORG_ID_F) 
				end 
				EVA_ACT_AMOUNT_MONTH
						
				from sctrans.T_RPT_WEEKLY_CASE_BASE_INFO week where week.MORT_TYPE in ('30016001','30016002') and week.TRANSFER_ISPASS = 1 and week.CASE_REC_STATUS = 0 and week.BELONG_WEEK_END_DAY = #belongEndWeekDay#
	            ]]>
			</baseSql>
			<orderBySql>
			</orderBySql>
			<groupSql>
			group by week.CASE_ORG_ID_F
			</groupSql>
		</searchSql>
		<grid>
			<table-row>
				<column type="both" name="ORG_ID" index="" checkbox="" title="地区" customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>
				<column type="virtual" name="ORG_NAME" index="" checkbox="" display="组织名称" customDict="qqcdOrgIdName" referencecol="ORG_ID"/>
				<column type="both" name="REC_NUM_WEEK" index="" checkbox="" title="收单案件总量(周)" customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>
				<column type="both" name="EVA_NUM_WEEK" index="" checkbox="" title="有评估费单数(周)" customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>
				<column type="both" name="REC_NUM_MONTH" index="" checkbox="" title="收单案件总量(月)" customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>
				<column type="both" name="EVA_NUM_MONTH" index="" checkbox="" title="有评估费单数(月)" customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>
				<column type="both" name="EVA_AMOUNT_WEEK" index="" checkbox="" title="评估费应收(周)" customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>
				<column type="both" name="EVA_ACT_AMOUNT_WEEK" index="" checkbox="" title="评估费实收(周)" customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>
				<column type="both" name="EVA_AMOUNT_MONTH" index="" checkbox="" title="评估费应收(月)" customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>
				<column type="both" name="EVA_ACT_AMOUNT_MONTH" index="" checkbox="" title="评估费实收(月)" customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>
			</table-row>
		</grid>
	</query>
	
	<query id="queryWeeklyBaseInfoList3" cacheResult="true">
	    <searchCondition>        
        </searchCondition>
		<searchSql>
			<baseSql>
				<![CDATA[
				select 
				week.CASE_ORG_ID_F ORG_ID,
				
				sum(case when cast(convert(varchar(8) , week.TRANSFER_APP_PASS_TIME, 112 ) as int) between #startWeekDay# and 
				#endWeekDay# then 1 else 0 end) GUOHU_NUM_WEEK,
				
				sum(case when cast(convert(varchar(8) , week.TRANSFER_APP_PASS_TIME, 112 ) as int) between #startWeekDay# and 
				#endWeekDay# and week.ELOAN_KA is not null then 1 else 0 end) KA_APP_NUM_WEEK,
				
				case when 
		        #startWeekDay#/100 = #endWeekDay#/100 then (select sum(case when a.BELONG_WEEK_END_DAY/100 = #belongEndWeekDay#/100 and cast(convert(varchar(8) , a.TRANSFER_APP_PASS_TIME, 112 ) as int) between #endWeekDay#/100*100+1 and 
				#endWeekDay# then 1 else 0 end) from sctrans.T_RPT_WEEKLY_CASE_BASE_INFO a where a.TRANSFER_ISPASS = 1 and a.CASE_ORG_ID_F = week.CASE_ORG_ID_F)  
				else 		        
		        (select sum(case when b.BELONG_WEEK_END_DAY/100 = #belongEndWeekDay#/100 and cast(convert(varchar(8) , b.TRANSFER_APP_PASS_TIME, 112 ) as int) between #lastMonthStartDay# and 
				#lastMonthEndDay# then 1 else 0 end) from sctrans.T_RPT_WEEKLY_CASE_BASE_INFO b where b.TRANSFER_ISPASS = 1 and b.CASE_ORG_ID_F = week.CASE_ORG_ID_F) 
				end  
				GUOHU_NUM_MONTH,
						
				case when 
		        #startWeekDay#/100 = #endWeekDay#/100 then (select sum(case when c.BELONG_WEEK_END_DAY/100 = #belongEndWeekDay#/100 and c.ELOAN_KA is not null and cast(convert(varchar(8) , c.TRANSFER_APP_PASS_TIME, 112 ) as int) between #endWeekDay#/100*100+1 and 
				#endWeekDay# then 1 else 0 end) from sctrans.T_RPT_WEEKLY_CASE_BASE_INFO c where c.TRANSFER_ISPASS = 1 and c.CASE_ORG_ID_F = week.CASE_ORG_ID_F) 
				else 		        
		        (select sum(case when d.BELONG_WEEK_END_DAY/100 = #belongEndWeekDay#/100 and d.ELOAN_KA is not null and cast(convert(varchar(8) , d.TRANSFER_APP_PASS_TIME, 112 ) as int) between #lastMonthStartDay# and 
				#lastMonthEndDay# then 1 else 0 end) from sctrans.T_RPT_WEEKLY_CASE_BASE_INFO d where d.TRANSFER_ISPASS = 1 and d.CASE_ORG_ID_F = week.CASE_ORG_ID_F) 
				end 
				KA_APP_NUM_MONTH,
						
		
		        case when 
		        #startWeekDay#/100 = #endWeekDay#/100 then (select sum(case when e.BELONG_WEEK_END_DAY/100 = #belongEndWeekDay#/100 and e.ELOAN_KA is not null and e.ELOAN_KA_AMOUNT is not null and cast(convert(varchar(8) , e.TRANSFER_APP_PASS_TIME, 112 ) as int) between #endWeekDay#/100*100+1 and 
				#endWeekDay# then 1 else 0 end) from sctrans.T_RPT_WEEKLY_CASE_BASE_INFO e where e.TRANSFER_ISPASS = 1 and e.CASE_ORG_ID_F = week.CASE_ORG_ID_F) 
				else 		        
		        (select sum(case when f.BELONG_WEEK_END_DAY/100 = #belongEndWeekDay#/100 and f.ELOAN_KA is not null and f.ELOAN_KA_AMOUNT is not null and cast(convert(varchar(8) , f.TRANSFER_APP_PASS_TIME, 112 ) as int) between #lastMonthStartDay# and 
				#lastMonthEndDay# then 1 else 0 end) from sctrans.T_RPT_WEEKLY_CASE_BASE_INFO f where f.TRANSFER_ISPASS = 1 and f.CASE_ORG_ID_F = week.CASE_ORG_ID_F) 
				end 
				KA_NUM_MONTH,
						
				(select count(1) from sctrans.T_TO_ELOAN_CASE ec where ec.EXCUTOR_TEAM = week.CASE_ORG_ID_F and EC.LOAN_SRV_CODE IN ('30004005','30004015') and cast(convert(varchar(6) , EC.CREATE_TIME, 112 ) as int) = #endWeekDay#/100) ELOAN_KA_APP_NUM_MONTH_1,
						
				(select count(1) from sctrans.T_TO_LOAN_AGENT la where la.MIGRATE IS NULL and la.EXECUTOR_TEAM = week.CASE_ORG_ID_F and LA.LOAN_SRV_CODE IN ('30004005','30004015') and cast(convert(varchar(6) , LA.CREATE_TIME, 112 ) as int) = #endWeekDay#/100) ELOAN_KA_APP_NUM_MONTH_2
						
				from sctrans.T_RPT_WEEKLY_CASE_BASE_INFO week where week.TRANSFER_ISPASS = 1 and week.BELONG_WEEK_END_DAY = #belongEndWeekDay#
	            ]]>
			</baseSql>
			<orderBySql>
			</orderBySql>
			<groupSql>
			group by week.CASE_ORG_ID_F
			</groupSql>
		</searchSql>
		<grid>
			<table-row>
				<column type="both" name="ORG_ID" index="" checkbox="" title="地区" customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>
				<column type="virtual" name="ORG_NAME" index="" checkbox="" display="组织名称" customDict="qqcdOrgIdName" referencecol="ORG_ID"/>
				<column type="both" name="GUOHU_NUM_WEEK" index="" checkbox="" title="过户单数" customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>
				<column type="both" name="KA_APP_NUM_WEEK" index="" checkbox="" title="卡申请单数" customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>
				<column type="both" name="GUOHU_NUM_MONTH" index="" checkbox="" title="过户单数" customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>
				<column type="both" name="KA_APP_NUM_MONTH" index="" checkbox="" title="卡申请单数" customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>
				<column type="both" name="KA_NUM_MONTH" index="" checkbox="" title="刷卡单数" customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>
				<column type="both" name="ELOAN_KA_APP_NUM_MONTH_1" index="" checkbox="" title="E+卡申请总量(月)[ELOAN_CASE表]" customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>
				<column type="both" name="ELOAN_KA_APP_NUM_MONTH_2" index="" checkbox="" title="E+卡申请总量(月)[LOAN_AGENT表]" customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>
			</table-row>
		</grid>
	</query>
	
	<query id="queryWeeklyBaseInfoList4" cacheResult="true">
	    <searchCondition>        
        </searchCondition>
		<searchSql>
			<baseSql>
				<![CDATA[
				select 
				week.CASE_ORG_ID_F ORG_ID,
				
				sum(case when cast(convert(varchar(8) , week.TRANSFER_APP_PASS_TIME, 112 ) as int) between #startWeekDay# and 
				#endWeekDay# then 1 else 0 end) GUOHU_NUM_WEEK,
				
				isnull(sum(case when cast(convert(varchar(8) , week.TRANSFER_APP_PASS_TIME, 112 ) as int) between #startWeekDay# and 
				#endWeekDay# then week.CASE_CON_PRICE else 0 end),0) HOUSE_PRICE_WEEK,
				
				sum(case when cast(convert(varchar(8) , week.TRANSFER_APP_PASS_TIME, 112 ) as int) between #startWeekDay# and 
				#endWeekDay# and week.ELOAN_PRO is not null then 1 else 0 end) PRO_APP_NUM_WEEK,
				
				isnull(sum(case when cast(convert(varchar(8) ,week.TRANSFER_APP_PASS_TIME, 112 ) as int) between #startWeekDay# and 
				#endWeekDay# and week.ELOAN_PRO is not null then week.ELOAN_PRO_AMOUNT else 0 end),0) PRO_APP_AMOUNT_WEEK,
								
				case when 
        		#startWeekDay#/100 = #endWeekDay#/100 then (select sum(case when a.BELONG_WEEK_END_DAY/100 = #belongEndWeekDay#/100 and cast(convert(varchar(8) , a.TRANSFER_APP_PASS_TIME, 112 ) as int) between #endWeekDay#/100*100+1 and 
				#endWeekDay# then 1 else 0 end) from sctrans.T_RPT_WEEKLY_CASE_BASE_INFO a where a.TRANSFER_ISPASS = 1 and a.CASE_ORG_ID_F = week.CASE_ORG_ID_F)   
				else         		
        		(select sum(case when b.BELONG_WEEK_END_DAY/100 = #belongEndWeekDay#/100 and cast(convert(varchar(8) , b.TRANSFER_APP_PASS_TIME, 112 ) as int) between #lastMonthStartDay# and 
				#lastMonthEndDay# then 1 else 0 end) from sctrans.T_RPT_WEEKLY_CASE_BASE_INFO b where b.TRANSFER_ISPASS = 1 and b.CASE_ORG_ID_F = week.CASE_ORG_ID_F)   
				end 
				GUOHU_NUM_MONTH,
				
				case when 
        		#startWeekDay#/100 = #endWeekDay#/100 then (select isnull(sum(case when c.BELONG_WEEK_END_DAY/100 = #belongEndWeekDay#/100 and cast(convert(varchar(8) , c.TRANSFER_APP_PASS_TIME, 112 ) as int) between #endWeekDay#/100*100+1 and 
				#endWeekDay# then c.CASE_CON_PRICE else 0 end),0) from sctrans.T_RPT_WEEKLY_CASE_BASE_INFO c where c.TRANSFER_ISPASS = 1 and c.CASE_ORG_ID_F = week.CASE_ORG_ID_F)   
				else         		
        		(select isnull(sum(case when d.BELONG_WEEK_END_DAY/100 = #belongEndWeekDay#/100 and cast(convert(varchar(8) , d.TRANSFER_APP_PASS_TIME, 112 ) as int) between #lastMonthStartDay# and 
				#lastMonthEndDay# then d.CASE_CON_PRICE else 0 end),0) from sctrans.T_RPT_WEEKLY_CASE_BASE_INFO d where d.TRANSFER_ISPASS = 1 and d.CASE_ORG_ID_F = week.CASE_ORG_ID_F)   
				end 
				HOUSE_PRICE_MONTH,
				

        		case when 
        		#startWeekDay#/100 = #endWeekDay#/100 then (select sum(case when e.BELONG_WEEK_END_DAY/100 = #belongEndWeekDay#/100 and e.ELOAN_PRO is not null and cast(convert(varchar(8) , e.TRANSFER_APP_PASS_TIME, 112 ) as int) between #endWeekDay#/100*100+1 and 
				#endWeekDay# then 1 else 0 end) from sctrans.T_RPT_WEEKLY_CASE_BASE_INFO e where e.TRANSFER_ISPASS = 1 and e.CASE_ORG_ID_F = week.CASE_ORG_ID_F)   
				else         		
        		(select sum(case when f.BELONG_WEEK_END_DAY/100 = #belongEndWeekDay#/100 and f.ELOAN_PRO is not null and cast(convert(varchar(8) , f.TRANSFER_APP_PASS_TIME, 112 ) as int) between #lastMonthStartDay# and 
				#lastMonthEndDay# then 1 else 0 end) from sctrans.T_RPT_WEEKLY_CASE_BASE_INFO f where f.TRANSFER_ISPASS = 1 and f.CASE_ORG_ID_F = week.CASE_ORG_ID_F)   
				end 
				PRO_APP_NUM_MONTH,
				

        		case when 
       			#startWeekDay#/100 = #endWeekDay#/100 then (select isnull(sum(case when g.BELONG_WEEK_END_DAY/100 = #belongEndWeekDay#/100 and g.ELOAN_PRO is not null and cast(convert(varchar(8) , g.TRANSFER_APP_PASS_TIME, 112 ) as int) between #endWeekDay#/100*100+1 and 
				#endWeekDay# then g.ELOAN_PRO_AMOUNT else 0 end),0) from sctrans.T_RPT_WEEKLY_CASE_BASE_INFO g where g.TRANSFER_ISPASS = 1 and g.CASE_ORG_ID_F = week.CASE_ORG_ID_F)    
				else         		
        		(select isnull(sum(case when h.BELONG_WEEK_END_DAY/100 = #belongEndWeekDay#/100 and h.ELOAN_PRO is not null and cast(convert(varchar(8) , h.TRANSFER_APP_PASS_TIME, 112 ) as int) between #lastMonthStartDay# and 
				#lastMonthEndDay# then h.ELOAN_PRO_AMOUNT else 0 end),0) from sctrans.T_RPT_WEEKLY_CASE_BASE_INFO h where h.TRANSFER_ISPASS = 1 and h.CASE_ORG_ID_F = week.CASE_ORG_ID_F)    
				end 
				PRO_APP_AMOUNT_MONTH,
				
				(select count(1) from sctrans.T_TO_ELOAN_CASE ec where ec.EXCUTOR_TEAM = week.CASE_ORG_ID_F and EC.LOAN_SRV_CODE NOT IN ('30004005','30004015') and cast(convert(varchar(6) , EC.CREATE_TIME, 112 ) as int) = #endWeekDay#/100)  ELOAN_PRO_APP_NUM_MONTH_1,
				
				(select count(1) from sctrans.T_TO_LOAN_AGENT la where la.MIGRATE IS NULL and la.EXECUTOR_TEAM = week.CASE_ORG_ID_F and LA.LOAN_SRV_CODE NOT IN ('30004005','30004015') and cast(convert(varchar(6) , LA.CREATE_TIME, 112 ) as int) = #endWeekDay#/100)  ELOAN_PRO_APP_NUM_MONTH_2
				
				from sctrans.T_RPT_WEEKLY_CASE_BASE_INFO week where week.TRANSFER_ISPASS = 1 and week.BELONG_WEEK_END_DAY = #belongEndWeekDay#
	            ]]>
			</baseSql>
			<orderBySql>
			</orderBySql>
			<groupSql>
			group by week.CASE_ORG_ID_F
			</groupSql>
		</searchSql>
		<grid>
			<table-row>
			    <column type="both" name="ORG_ID" index="" checkbox="" title="地区" customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>
			    <column type="virtual" name="ORG_NAME" index="" checkbox="" display="组织名称" customDict="qqcdOrgIdName" referencecol="ORG_ID"/>
			    <column type="both" name="GUOHU_NUM_WEEK" index="" checkbox="" title="E+过户单数(周)" customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>
			    <column type="both" name="HOUSE_PRICE_WEEK" index="" checkbox="" title="房屋价格(周)" customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>
			    <column type="both" name="PRO_APP_NUM_WEEK" index="" checkbox="" title="E+申请单数(周)" customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>
			    <column type="both" name="PRO_APP_AMOUNT_WEEK" index="" checkbox="" title="E+申请金额(周)" customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>
			    <column type="both" name="GUOHU_NUM_MONTH" index="" checkbox="" title="过户单数(周)" customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>
			    <column type="both" name="HOUSE_PRICE_MONTH" index="" checkbox="" title="房屋价格(月)" customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>
			    <column type="both" name="PRO_APP_NUM_MONTH" index="" checkbox="" title="E+申请单数(月)" customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>
			    <column type="both" name="PRO_APP_AMOUNT_MONTH" index="" checkbox="" title="E+申请金额(月)" customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>
			    <column type="both" name="ELOAN_PRO_APP_NUM_MONTH_1" index="" checkbox="" title="E+申请总量(月)[ELOAN_CASE表]" customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/> 
			    <column type="both" name="ELOAN_PRO_APP_NUM_MONTH_2" index="" checkbox="" title="E+申请总量(月)[LOAN_AGENT表]" customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/> 
			</table-row>
		</grid>
	</query>
</querys>