<?xml version="1.0" encoding="UTF-8"?>
<querys>
	<dicts>
		<customDict id="qqGetMortComCount" beanName="qqGetMortComCount" />
		<customDict id="qqGetMortPrfCount" beanName="qqGetMortPrfCount" />
		<customDict id="qqGetNoMortCount" beanName="qqGetNoMortCount" />
		<customDict id="qqGetNoMortCount" beanName="qqGetNoMortCount" />

	</dicts>
<formatters>
		<formatter id="dateFormatter" ref="" class="com.aist.common.quickQuery.formatter.DateFormatter">
			<properties>
				<property name="pattern">yyyy-MM-dd HH:mm:ss</property>
			</properties>
		</formatter>
		<formatter id="dateFormatter1" ref="" class="com.aist.common.quickQuery.formatter.DateFormatter" />
		<formatter id="integerFormater" ref="" class="com.aist.common.quickQuery.formatter.NumberFormatter">
			<properties>
				<property name="maximumFractionDigits">0</property>
			</properties>
		</formatter>
		<formatter id="emailFormater" ref="" class="com.aist.common.quickQuery.formatter.EmailFormatter"/>
	</formatters>
	<query id="querySignFaceList" cacheCount="true">
	    <searchCondition>
	        
        </searchCondition>
		<searchSql>
			<baseSql>
				<![CDATA[
				select main.district_id,
				(select count(1) from sctrans.T_RPT_CASE_PROCESS_STATIS a where a.district_id = main.district_id and convert(varchar(7),a.RECEIVED_TIME ,120)= '1998-05') dispatch_num,
				(select count(1) from sctrans.T_RPT_CASE_PROCESS_STATIS b where b.district_id = main.district_id and convert(varchar(7),b.SIGN_TIME ,120)= '1998-05') sign_num,
				(select count(1) from sctrans.T_RPT_CASE_PROCESS_STATIS c where c.district_id = main.district_id and convert(varchar(7),c.HOUSE_TRANFER_TIME ,120)= '1998-05') guo_num,
				(select count(1) from sctrans.T_RPT_CASE_PROCESS_STATIS d where d.district_id = main.district_id and d.MORTGAGE_LOAN_TYPE in ('30016001','30016002')) com_num,
				(select count(1) from sctrans.T_RPT_CASE_PROCESS_STATIS e where e.district_id = main.district_id and e.MORTGAGE_LOAN_TYPE = '30016003') prf_num
				from sctrans.T_RPT_CASE_PROCESS_STATIS main				
	            ]]>
			</baseSql>
			<orderBySql>
			</orderBySql>
			<groupSql>
			group by main.district_id
			</groupSql>
		</searchSql>
		<grid>
			<table-row>
				<column type="both" name="district_id" index="" checkbox="" title="地区" customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>
				<column type="both" name="dispatch_num" index="" checkbox="" title="派单量" expType="Integer" customDict="" sysDict="" format="" beanFormatter="numberFormater" width="90" isSort="true" align="" halign="" order="" resizable=""/>
				<column type="both" name="sign_num" index="" checkbox="" title="签约量" expType="Integer" customDict="" sysDict="" format="" beanFormatter="numberFormater" width="180" align="" halign="" order="" resizable=""/>
				<column type="both" name="guo_num" index="" checkbox="" title="过户量" expType="Integer" customDict="" sysDict="" beanFormatter="numberFormater" format="" width="60" isSort="true" align="" halign="" order="" resizable="" />
				<column type="both" name="com_num" index="" checkbox="" title="商贷量" expType="Integer" customDict="" sysDict="" format="" beanFormatter="numberFormater" width="60" align="" halign="" order="" resizable="" />
				<column type="both" name="prf_num" index="" checkbox="" title="纯公积金量" expType="Integer" customDict="" sysDict="" format="" beanFormatter="numberFormater" width="60" align="" halign="" order="" resizable="" />						
			</table-row>
		</grid>
	</query>

	<query id="queryHourseTransferCaseBaseInfo">
		<searchCondition>

		</searchCondition>
		<searchSql>
			<baseSql>
				<![CDATA[
					select
						tb1.DISTRICT_ID,--区域ID
						sum(MORTGAGET_TOTAL_AMOUNT) as MORTGAGET_TOTAL_AMOUNT,--总共贷款金额
						sum(MORTGAGET_COM_AMOUNT) as MORTGAGET_COM_AMOUNT,--商业贷款金额
						sum(MORTGAGET_PRF_AMOUNT) as MORTGAGET_PRF_AMOUNT,--公积金贷款金额
						<ifNotNull choiceMonth>
						 #choiceMonth# as CHOICE_MONTH,
						</ifNotNull>

						( ) PRF_COUNT,--公积金贷款的案件数
						( ) NO_MORT_COUNT,--无贷款的案件数
						() LOST_COUNT,--流失案件数
						() LOST_AMOUNT--流失贷款金额
					from
					sctrans.T_RPT_HISTORY_CASE_BASE_INFO tb1
					where
					1=1
					and HOURSE_TRANSFER_AGREE_STATUS=1
					and convert(varchar(7),HOURSE_TRANSFER_APPROVE_DATE,120)=#choiceMonth#

	            ]]>
			</baseSql>
			<orderBySql>
			</orderBySql>
			<groupSql>
				group by DISTRICT_ID
			</groupSql>
		</searchSql>
		<grid>
			<table-row>
				<column type="both" name="DISTRICT_ID" title="贵宾服务部ID"  sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>
				<column type="both" name="DISTRICT_NAME"  title="贵宾服务部名称"  sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>
				<column type="both" name="MORTGAGET_TOTAL_AMOUNT" title="总共贷款金额"  sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>
				<column type="both" name="MORTGAGET_COM_AMOUNT"  title="商业贷款金额"  sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>
				<column type="both" name="MORTGAGET_PRF_AMOUNT"  title="公积金贷款金额"  sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>
				<column type="both" name="CHOICE_MONTH"  title="选择月份"  sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>

				<column type="virtual" name="MORTGAGET_TOTAL_COUNT" title="商业贷款的案件数" referencecol="DISTRICT_ID,CHOICE_MONTH" isDynamic="true" index="" checkbox="" customDict="qqGetMortComCount" sysDict="" format=""  width="60" isSort="true" align="" halign="" order="" resizable=""/>

				<column type="virtual" name="PRF_COUNT"  title="公积金贷款的案件数" referencecol="DISTRICT_ID,CHOICE_MONTH" isDynamicDict="true" customDict="qqGetMortPrfCount" sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>

				<column type="virtual" name="NO_MORT_COUNT"  title="无贷款的案件数" referencecol="DISTRICT_ID,CHOICE_MONTH" isDynamicDict="true" customDict="qqGetNoMortCount"  sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>

				<column type="virtual" name="LOST_COUNT"  title="流失案件数" referencecol="DISTRICT_ID,CHOICE_MONTH" isDynamicDict="true" customDict="qqGetLost"  sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>

				<column type="virtual" name="LOST_AMOUNT" title="流失贷款金额" referencecol="DISTRICT_ID,CHOICE_MONTH" isDynamicDict="true" customDict="qqGetCasePropertyInfo"  sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable=""/>

			</table-row>
		</grid>
	</query>
</querys>