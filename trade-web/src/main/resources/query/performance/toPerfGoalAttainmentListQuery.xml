<?xml version="1.0" encoding="UTF-8"?>
<querys>
		<dicts>
			<customDict id="qqcdOrgIdName" beanName="qqcdOrgIdName"></customDict>
			<customDict id="getRealNameByUserId" beanName="getRealNameByUserId"></customDict>
		</dicts>
		<formatters>
			<formatter id="dateFormatter" ref=""
				class="com.aist.common.quickQuery.formatter.DateFormatter">
				<properties>
					<property name="pattern">yyyy-MM-dd</property>
				</properties>
			</formatter>
		</formatters>
	<query id="queryPerfGoalAttainmentList" cacheCount="true">
		<searchCondition>
		</searchCondition>
		<searchSql>
			<baseSql>
				<![CDATA[
			SELECT
				pg.DISTRICT as viewObject,
				pg.BELONG_MONTH as belongMonth,
 				pg.GOAL_PERF as goalPerf,
  				rp.SHARE_AMOUNT as shareAmount,
				rp.SHARES_RATE*rp.SHARE_BASE/pg.GOAL_PERF*100 as completionRate
			FROM
			sctrans.T_TS_PERF_GOAL pg
			LEFT JOIN sctrans.T_TS_RECEIVABLE_PERF rp
			ON (pg.PKID = rp.PKID) 
			LEFT JOIN sctrans.t_yucui_org_hierarchy yoh ON (pg.TEAM = yoh.ORG_ID)
			where pg.STATUS=1 
			and rp.STATUS='GENERATED' and rp.IS_DELETED='0'
			AND (
				yoh.DISTRICT_ID = #orgId#
				OR yoh.TEAM_ID = #orgId#
				OR yoh.HQ_ID = #orgId#
			)
			and convert(varchar(7),pg.BELONG_MONTH,120) = #time# 
		]]>
			</baseSql>
			<groupSql>
			</groupSql>
		</searchSql>
		<grid>
			<table-row>
				<column type="both" name="viewObject" customDict="qqcdOrgIdName"/>
				<column type="both" name="belongMonth" beanFormatter="dateFormatterMM" />
				<column type="both" name="goalPerf" />
				<column type="both" name="shareAmount" />
				<column type="both" name="completionRate" />
			</table-row>
		</grid>
	</query>
	<query id="queryPerfGoalAttainmentListRyjb" cacheCount="true">
		<searchCondition>
		</searchCondition>
		<searchSql>
			<baseSql>
				<![CDATA[
			SELECT
				pg.USER_ID viewObject,
				pg.BELONG_MONTH as belongMonth,
				SUM (pg.GOAL_PERF) AS goalPerf,
				SUM (rp.SHARE_AMOUNT) AS shareAmount,
				SUM (rp.SHARE_AMOUNT) / SUM (pg.GOAL_PERF) / 100 AS completionRate 
			FROM
			sctrans.T_TS_PERF_GOAL pg
			LEFT JOIN sctrans.T_TS_RECEIVABLE_PERF rp
			ON (pg.USER_ID = rp.USER_ID) 
			<if test = "USER_JOBCODE !='TJYGW' and TJYGW!='TJYZL' ">
				LEFT JOIN sctrans.t_yucui_org_hierarchy yoh ON (pg.TEAM = yoh.ORG_ID)
			</if>
				WHERE
					pg.STATUS = 1 and rp.STATUS='GENERATED' and rp.IS_DELETED='0'
			<if test = "USER_JOBCODE !='TJYGW' and TJYGW!='TJYZL' ">
				AND (
					yoh.DISTRICT_ID = #orgId#
					OR yoh.TEAM_ID = #orgId#
					OR yoh.HQ_ID = #orgId#
				)
			</if>
			<if test="USER_JOBCODE !='TJYGW' and TJYGW!='TJYZL' and  yuCuiOriGrpId != null and yuCuiOriGrpId != 'null' and yuCuiOriGrpId != '' ">
			AND (
				yoh.DISTRICT_ID = #yuCuiOriGrpId#
				OR yoh.TEAM_ID = #yuCuiOriGrpId#
				OR yoh.HQ_ID = #yuCuiOriGrpId#
				)
			</if>
			 and convert(varchar(7),pg.BELONG_MONTH,120) = #time# GROUP  BY pg.USER_ID,pg.BELONG_MONTH HAVING 1=1 
		]]>
			</baseSql>
			<groupSql>
			</groupSql>
		</searchSql>
		<grid>
			<table-row>
				<column type="both" name="viewObject" customDict="getRealNameByUserId"/>
				<column type="both" name="belongMonth" beanFormatter="dateFormatterMM" />
				<column type="both" name="goalPerf" />
				<column type="both" name="shareAmount" />
				<column type="both" name="completionRate" />
			</table-row>
		</grid>
	</query>
	<query id="queryPerfGoalAttainmentListzbjb" cacheCount="true">
		<searchCondition>
			<!-- <condition field="pg.DISTRICT" name="yuCuiOriGrpId" label="" searchType="EQ" showType="" showCallback="" defaultValue=""/> -->
		</searchCondition>
		<searchSql>
			<baseSql>
				<![CDATA[
			SELECT
				pg.TEAM AS viewObject,
				pg.BELONG_MONTH AS belongMonth,
				SUM (pg.GOAL_PERF) AS goalPerf,
				SUM (rp.SHARE_AMOUNT) AS shareAmount,
				SUM (rp.SHARE_AMOUNT) / SUM (pg.GOAL_PERF) / 100 AS completionRate 
			FROM
			sctrans.T_TS_PERF_GOAL pg
			LEFT JOIN sctrans.T_TS_RECEIVABLE_PERF rp
			ON (pg.TEAM = rp.TEAM_ID) 
			LEFT JOIN sctrans.t_yucui_org_hierarchy yoh ON (pg.TEAM = yoh.ORG_ID)
			where pg.STATUS=1 and rp.STATUS='GENERATED' and rp.IS_DELETED='0'
			AND (
				yoh.DISTRICT_ID = #orgId#
				OR yoh.TEAM_ID = #orgId#
				OR yoh.HQ_ID = #orgId#
			)
			<if test="yuCuiOriGrpId != null and yuCuiOriGrpId != 'null' and yuCuiOriGrpId != '' ">
			AND (
				yoh.DISTRICT_ID = #yuCuiOriGrpId#
				OR yoh.TEAM_ID = #yuCuiOriGrpId#
				OR yoh.HQ_ID = #yuCuiOriGrpId#
				)
			</if>
			
			and convert(varchar(7),pg.BELONG_MONTH,120) = #time# GROUP  BY pg.TEAM,pg.BELONG_MONTH HAVING 1=1 
		]]>
			</baseSql>
			<groupSql>
			</groupSql>
		</searchSql>
		<grid>
			<table-row>
				<column type="both" name="viewObject" customDict="qqcdOrgIdName"/>
				<column type="both" name="belongMonth" beanFormatter="dateFormatterMM" />
				<column type="both" name="goalPerf" />
				<column type="both" name="shareAmount" />
				<column type="both" name="completionRate" />
			</table-row>
		</grid>
	</query>
	<query id="queryPerfGoalAttainmentListgbfwzx" cacheCount="true">
		<searchCondition>
		</searchCondition>
		<searchSql>
			<baseSql>
				<![CDATA[
			SELECT
				pg.DISTRICT as viewObject,
				pg.BELONG_MONTH AS belongMonth,
				SUM (pg.GOAL_PERF) AS goalPerf,
				SUM (rp.SHARE_AMOUNT) AS shareAmount,
				SUM (rp.SHARE_AMOUNT) / SUM (pg.GOAL_PERF) / 100 AS completionRate 
			FROM
			sctrans.T_TS_PERF_GOAL pg
			LEFT JOIN sctrans.T_TS_RECEIVABLE_PERF rp
			ON (pg.TEAM = rp.TEAM_ID)
			LEFT JOIN sctrans.t_yucui_org_hierarchy yoh ON (pg.TEAM = yoh.ORG_ID)
			where pg.STATUS=1 and rp.STATUS='GENERATED' and rp.IS_DELETED='0'
			AND (
				yoh.DISTRICT_ID = #orgId#
				OR yoh.TEAM_ID = #orgId#
				OR yoh.HQ_ID = #orgId#
			)
			<if test="yuCuiOriGrpId != null and yuCuiOriGrpId != 'null' and yuCuiOriGrpId != '' ">
			AND (
				yoh.DISTRICT_ID = #yuCuiOriGrpId#
				OR yoh.TEAM_ID = #yuCuiOriGrpId#
				OR yoh.HQ_ID = #yuCuiOriGrpId#
				)
			</if>
			and convert(varchar(7),pg.BELONG_MONTH,120) = #time# GROUP  BY pg.DISTRICT,pg.BELONG_MONTH HAVING 1=1 
		]]>
			</baseSql>
			<groupSql>
			</groupSql>
		</searchSql>
		<grid>
			<table-row>
				<column type="both" name="viewObject" customDict="qqcdOrgIdName"/>
				<column type="both" name="belongMonth" beanFormatter="dateFormatterMM" />
				<column type="both" name="goalPerf" />
				<column type="both" name="shareAmount" />
				<column type="both" name="completionRate" />
			</table-row>
		</grid>
	</query>
</querys>