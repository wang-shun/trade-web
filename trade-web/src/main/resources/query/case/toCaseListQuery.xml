<?xml version="1.0" encoding="UTF-8"?>
<querys>
<dicts>
		<!-- <customDict id="getStatusNameByCode" beanName="qqcdDict30001"></customDict>
		<customDict id="qqcdProcessorName" beanName="qqcdProcessorName"></customDict>
		<customDict id="qqcdUojByUserId" beanName="qqcdUojByUserId" />
		<customDict id="qqcdOrgNameByCode" beanName="qqcdOrgNameByCode" />
		<customDict id="qqcdSeller" beanName="qqcdSeller" />
		<customDict id="qqcdBuyer" beanName="qqcdBuyer" />
		<customDict id="qqcdBackProcessorName" beanName="qqcdBackProcessorName" />
		<customDict id="qqcdDict30003" beanName="qqcdDict30003" /> -->
		
		<customDict id="getCaseOverviewInfo" beanName="getCaseOverviewInfo" />
</dicts>
<formatters>
		<formatter id="dateFormatter" ref="" class="com.aist.common.quickQuery.formatter.DateFormatter">
			<properties>
				<property name="pattern">yyyy-MM-dd HH:mm:ss</property>
			</properties>
		</formatter>
		<formatter id="numberFormater" ref="" class="com.aist.common.quickQuery.formatter.NumberFormatter">
			<properties>
				<property name="groupingUsed">true</property>
				<property name="maximumFractionDigits">3</property>
				<property name="maximumIntegerDigits">40</property>
				<property name="minimumFractionDigits">0</property>
				<property name="minimumIntegerDigits">1</property>
			</properties>
		</formatter>
		<formatter id="integerFormater" ref="" class="com.aist.common.quickQuery.formatter.NumberFormatter">
			<properties>
				<property name="maximumFractionDigits">0</property>
			</properties>
		</formatter>
		<formatter id="emailFormater" ref="" class="com.aist.common.quickQuery.formatter.EmailFormatter"/>
	</formatters>
	<query id="queryCastListItemList" cacheCount="true">
		<searchCondition>

		   <condition field="B.CASE_CODE"  name="caseCode" label="案件编号" searchType="EQ" showType="" showCallback="" defaultValue=""/>
		   <condition field="B.ctmCode"  name="ctmCode" label="CTM编号" searchType="EQ" showType="" showCallback="" defaultValue=""/>

           <condition field="B.CASE_PROPERTY"  name="caseProperty" label="案件类型" searchType="EQ" showType="" showCallback="" defaultValue=""/>
           <condition field="B.STATUS_OLD"         name="status" label="服务阶段选择" searchType="EQ" showType="" showCallback="" defaultValue=""/>
           <condition field="B.CLOSE_TIME"  name="approveTimeStart" label="" searchType="GTE" showType="" showCallback="" defaultValue=""/>
           <condition field="B.CLOSE_TIME"  name="approveTimeEnd" label="" searchType="LTE" showType="" showCallback="" defaultValue=""/>
           <condition field="B.CREATE_TIME"    name="createTimeStart" label="" searchType="GTE" showType="" showCallback="" defaultValue=""/>
           <condition field="B.CREATE_TIME"    name="createTimeEnd" label="" searchType="LTE" showType="" showCallback="" defaultValue=""/>
           <condition field="B.RES_DATE"       name="resDateStart" label="" searchType="GTE" showType="" showCallback="" defaultValue=""/>
           <condition field="B.RES_DATE"       name="resDateEnd" label="" searchType="LTE" showType="" showCallback="" defaultValue=""/>
           <condition field="B.AGENT_NAME"     name="agentName" label="经纪人" searchType="LIKE" showType="" showCallback="" defaultValue=""/>
           <condition field="B.PROPERTY_ADDR"  name="propertyAddr" label="物业地址" searchType="LIKE" showType="" showCallback="" defaultValue=""/>
           <!-- <condition field="B.AGENT_ORG_NAME" name="agentOrgName" label="经纪人机构" searchType="LIKE" showType="" showCallback="" defaultValue=""/> -->

<!--       <condition field="B.SRV_CAT_STR" name="srvCode1"  label="" searchType="LIKE" showType="" showCallback="" defaultValue=""/>
           <condition field="B.SRV_CAT_STR" name="srvCode2"  label="" searchType="LIKE" showType="" showCallback="" defaultValue=""/>
           <condition field="B.SRV_CAT_STR" name="srvCode3"  label="" searchType="LIKE" showType="" showCallback="" defaultValue=""/>
           <condition field="B.SRV_CAT_STR" name="srvCode4"  label="" searchType="LIKE" showType="" showCallback="" defaultValue=""/>
           <condition field="B.SRV_CAT_STR" name="srvCode5"  label="" searchType="LIKE" showType="" showCallback="" defaultValue=""/>
           <condition field="B.SRV_CAT_STR" name="srvCode6"  label="" searchType="LIKE" showType="" showCallback="" defaultValue=""/>
           <condition field="B.SRV_CAT_STR" name="srvCode7"  label="" searchType="LIKE" showType="" showCallback="" defaultValue=""/>
           <condition field="B.SRV_CAT_STR" name="srvCode8"  label="" searchType="LIKE" showType="" showCallback="" defaultValue=""/>
           <condition field="B.SRV_CAT_STR" name="srvCode9"  label="" searchType="LIKE" showType="" showCallback="" defaultValue=""/>
           <condition field="B.SRV_CAT_STR" name="srvCode11" label="" searchType="LIKE" showType="" showCallback="" defaultValue=""/>
           <condition field="B.SRV_CAT_STR" name="srvCode12" label="" searchType="LIKE" showType="" showCallback="" defaultValue=""/>
           <condition field="B.SRV_CAT_STR" name="srvCode13" label="" searchType="LIKE" showType="" showCallback="" defaultValue=""/> -->




           <!-- <condition field="G.REAL_CON_TIME"  name="realConTimeStart" label="" searchType="GTE" showType="" showCallback="" defaultValue=""/>
           <condition field="G.REAL_CON_TIME"  name="realConTimeEnd" label="" searchType="LTE" showType="" showCallback="" defaultValue=""/>
           <condition field="H.REAL_HT_TIME"   name="realHtTimeStart" label="" searchType="GTE" showType="" showCallback="" defaultValue=""/>
           <condition field="H.REAL_HT_TIME"   name="realHtTimeEnd" label="" searchType="LTE" showType="" showCallback="" defaultValue=""/> -->

           <!-- <condition field="I.REAL_PROPERTY_GET_TIME" name="realPropertyGetTimeStart" label="" searchType="GTE" showType="" showCallback="" defaultValue=""/>
           <condition field="I.REAL_PROPERTY_GET_TIME" name="realPropertyGetTimeEnd" label="" searchType="LTE" showType="" showCallback="" defaultValue=""/> -->

           <!-- <condition field="J.SIGN_DATE"   name="signDateStart" label="" searchType="GTE" showType="" showCallback="" defaultValue=""/>
           <condition field="J.SIGN_DATE"   name="signDateEnd" label="" searchType="LTE" showType="" showCallback="" defaultValue=""/>
           <condition field="J.LEND_DATE"   name="lendDateStart" label="" searchType="GTE" showType="" showCallback="" defaultValue=""/>
           <condition field="J.LEND_DATE"   name="lendDateEnd" label="" searchType="LTE" showType="" showCallback="" defaultValue=""/> -->

			<!-- 
				(SELECT U.REAL_NAME FROM   sctrans.SYS_USER U    inner join  sctrans.T_TO_CASE C on U.ID=C.LEADING_PROCESS_ID AND C.CASE_CODE = NB.CASE_CODE)  FONT_NAME,
			 -->
          </searchCondition>
		<searchSql>
			<baseSql>
				<![CDATA[
			SELECT * from(

					SELECT
					    NB.PKID,
					    NB.STATUS AS STATUS_OLD,
					    NB.RED_COUNT,
                        NB.PROPERTY_ADDR,
                        NB.CASE_CODE,
                        NB.AGENT_NAME,
                        NB.AGENT_CODE,
                        NB.GRP_NAME AGENT_ORG_NAME,
                        NB.CTM_CODE as ctmCode,
						NB.AGENT_PHONE,
						NB.CASE_PROPERTY,
						NB.CLOSE_TIME,
						NB.CREATE_TIME,
						NB.RES_DATE,						
                        (select Count(PKID) from sctrans.T_TO_MODULE_SUBSCRIBE ttms where ttms.SUBSCRIBER_ID=:sessionUserId and ttms.MODULE_CODE=NB.CASE_CODE ) as SUBSCRIBE_COUNT
					FROM sctrans.V_CASE_LIST_BASE NB 
			    	  
			    	<ifNotNull guohuApproveTime>
						LEFT JOIN sctrans.T_HI_WORKFLOW w ON NB.CASE_CODE = w.CASE_CODE AND w.BUSINESS_KEY = 'operation_process' AND w.STATUS IN ('0', '4') AND w.PKID = (select max(PKID) from sctrans.T_HI_WORKFLOW WHERE CASE_CODE = w.CASE_CODE AND BUSINESS_KEY = 'operation_process' AND STATUS IN ('0', '4'))
						LEFT JOIN sctrans.act_hi_varinst v ON v.PROC_INST_ID_ = w.INST_CODE AND v.name_ = 'GuohuApprove' AND v.long_ = 1
						LEFT JOIN (
							select * from (
							 select proc_inst_id_,assignee_,end_time_,row_number() over(partition by proc_inst_id_ order by end_time_ desc) rn
							 from sctrans.act_hi_taskinst WHERE task_def_key_ = 'GuohuApprove'
							) taskInst where taskInst.rn &lt;= 1
						) t ON t.proc_inst_id_ = w.inst_code
					</ifNotNull>
					
					
					where 1=1 
					and (EXISTS ( SELECT 1 FROM SCTRANS.T_TO_CASE C WHERE C.CASE_CODE = NB.CASE_CODE
					  	    <ifNotNull idflag> and C.LEADING_PROCESS_ID = #userId# 	</ifNotNull>
					  	    <ifNotNull queryorgs> AND C.ORG_ID in (#queryorgs#)     </ifNotNull>)
			    	  OR EXISTS ( SELECT 1 FROM SCTRANS.T_TG_SERV_ITEM_AND_PROCESSOR C WHERE C.CASE_CODE = NB.CASE_CODE
			    	  		<ifNotNull idflag> and C.PROCESSOR_ID = #userId# 	</ifNotNull>
			    	  		<ifNotNull queryorgs> AND C.ORG_ID in (#queryorgs#)    </ifNotNull>)
			    	  OR EXISTS (SELECT 1
                      			 FROM  SCTRANS.T_TG_SERV_ITEM_AND_PROCESSOR A
                                 INNER JOIN ( SELECT T.*,S.id
                                              FROM SCTRANS.T_TL_TASK_REASSIGNT_LOG T
                                              LEFT JOIN sctrans.SYS_USER S ON t.ORI_ASSIGNEE = S.username
                                           ) L ON L.id = A.PROCESSOR_ID and L.case_code = A.case_code
                                             <ifNotNull userLoginName> AND L.NEW_ASSIGNEE = #userLoginName#</ifNotNull>
                      WHERE     NB.CASE_CODE = A.CASE_CODE
                                AND A.SRV_CODE IN ( '3000400201', '3000401002' ) )
			    	  )
					
					<ifNotNull realConTimeStart>
						and EXISTS(select 1 from sctrans.T_TO_SIGN G where NB.CASE_CODE = G.CASE_CODE AND G.REAL_CON_TIME >= #realConTimeStart#)
					</ifNotNull>
					<ifNotNull realConTimeEnd>
						and EXISTS(select 1 from sctrans.T_TO_SIGN G where NB.CASE_CODE = G.CASE_CODE AND G.REAL_CON_TIME &lt;= #realConTimeEnd#)
					</ifNotNull>

					<ifNotNull realHtTimeStart>
						AND EXISTS(select 1 from sctrans.T_TO_HOUSE_TRANSFER H where NB.CASE_CODE = H.CASE_CODE and H.REAL_HT_TIME >= #realHtTimeStart#)
					</ifNotNull>
					<ifNotNull realHtTimeEnd>
						AND EXISTS(select 1 from sctrans.T_TO_HOUSE_TRANSFER H where NB.CASE_CODE = H.CASE_CODE AND H.REAL_HT_TIME &lt;= #realHtTimeEnd#)
					</ifNotNull>

					<ifNotNull realPropertyGetTimeStart>
						AND EXISTS(select 1 from sctrans.T_TO_GET_PROPERTY_BOOK I where NB.CASE_CODE = I.CASE_CODE AND I.REAL_PROPERTY_GET_TIME >= #realPropertyGetTimeStart#)
					</ifNotNull>
					<ifNotNull realPropertyGetTimeEnd>
						AND EXISTS(select 1 from sctrans.T_TO_GET_PROPERTY_BOOK I where NB.CASE_CODE = I.CASE_CODE AND I.REAL_PROPERTY_GET_TIME &lt;= #realPropertyGetTimeEnd#)
					</ifNotNull>

     				<ifNotNull guestname>
						AND EXISTS (SELECT 1 FROM sctrans.T_TG_GUEST_INFO WHERE CASE_CODE = NB.CASE_CODE and GUEST_NAME LIKE '%'+#guestname#+'%' )
					</ifNotNull>
					
					<ifNotNull proName>
						AND (EXISTS (SELECT 1 FROM sctrans.T_TO_CASE c where c.CASE_CODE = NB.CASE_CODE and c.LEADING_PROCESS_ID = #proName#)
						    OR
						    EXISTS (SELECT 1 FROM sctrans.T_TG_SERV_ITEM_AND_PROCESSOR p where p.CASE_CODE = NB.CASE_CODE and p.PROCESSOR_ID = #proName#))
					</ifNotNull>
					
					<ifNotNull agentOrgName>
						AND  EXISTS(SELECT 1 FROM sctrans.V_USER_ORG_JOB uoj where uoj.user_id = NB.AGENT_CODE  AND uoj.org_id = #agentOrgName# )
					</ifNotNull>
					
					<ifNotNull srvCode1>
						AND exists( select 1 from sctrans.T_TG_SERV_ITEM_AND_PROCESSOR where CASE_CODE = NB.CASE_CODE AND SRV_CAT = #srvCode1#)
					</ifNotNull>
					<ifNotNull srvCode2>
						AND exists( select 1 from sctrans.T_TG_SERV_ITEM_AND_PROCESSOR where CASE_CODE = NB.CASE_CODE AND SRV_CAT = #srvCode2#)
					</ifNotNull>
					<ifNotNull srvCode3>
						AND exists( select 1 from sctrans.T_TG_SERV_ITEM_AND_PROCESSOR where CASE_CODE = NB.CASE_CODE AND SRV_CAT = #srvCode3#)
					</ifNotNull>
					<ifNotNull srvCode4>
						AND exists( select 1 from sctrans.T_TG_SERV_ITEM_AND_PROCESSOR where CASE_CODE = NB.CASE_CODE AND SRV_CAT = #srvCode4#)
					</ifNotNull>
					<ifNotNull srvCode5>
						AND exists( select 1 from sctrans.T_TG_SERV_ITEM_AND_PROCESSOR where CASE_CODE = NB.CASE_CODE AND SRV_CAT = #srvCode5#)
					</ifNotNull>
					<ifNotNull srvCode6>
						AND exists( select 1 from sctrans.T_TG_SERV_ITEM_AND_PROCESSOR where CASE_CODE = NB.CASE_CODE AND SRV_CAT = #srvCode6#)
					</ifNotNull>
					<ifNotNull srvCode7>
						AND exists( select 1 from sctrans.T_TG_SERV_ITEM_AND_PROCESSOR where CASE_CODE = NB.CASE_CODE AND SRV_CAT = #srvCode7#)
					</ifNotNull>
					<ifNotNull srvCode8>
						AND exists( select 1 from sctrans.T_TG_SERV_ITEM_AND_PROCESSOR where CASE_CODE = NB.CASE_CODE AND SRV_CAT = #srvCode8#)
					</ifNotNull>
					<ifNotNull srvCode9>
						AND exists( select 1 from sctrans.T_TG_SERV_ITEM_AND_PROCESSOR where CASE_CODE = NB.CASE_CODE AND SRV_CAT = #srvCode9#)
					</ifNotNull>
					<ifNotNull srvCode10>
						AND exists( select 1 from sctrans.T_TG_SERV_ITEM_AND_PROCESSOR where CASE_CODE = NB.CASE_CODE AND SRV_CAT = #srvCode10#)
					</ifNotNull>
					<ifNotNull srvCode11>
						AND exists( select 1 from sctrans.T_TG_SERV_ITEM_AND_PROCESSOR where CASE_CODE = NB.CASE_CODE AND SRV_CAT = #srvCode11#)
					</ifNotNull>
					<ifNotNull srvCode12>
						AND exists( select 1 from sctrans.T_TG_SERV_ITEM_AND_PROCESSOR where CASE_CODE = NB.CASE_CODE AND SRV_CAT = #srvCode12#)
					</ifNotNull>
					<ifNotNull srvCode13>
						AND exists( select 1 from sctrans.T_TG_SERV_ITEM_AND_PROCESSOR where CASE_CODE = NB.CASE_CODE AND SRV_CAT = #srvCode13#)
					</ifNotNull>
					<ifNotNull srvCode14>
						AND exists( select 1 from sctrans.T_TG_SERV_ITEM_AND_PROCESSOR where CASE_CODE = NB.CASE_CODE AND SRV_CAT = #srvCode14#)
					</ifNotNull>
					<ifNotNull srvCode15>
						AND exists( select 1 from sctrans.T_TG_SERV_ITEM_AND_PROCESSOR where CASE_CODE = NB.CASE_CODE AND SRV_CAT = #srvCode15#)
					</ifNotNull>
					
					<ifNotNull signlendDate>
					  and exists ( select 1 from sctrans.T_TO_MORTGAGE J where NB.CASE_CODE = J.CASE_CODE and is_active='1'
					</ifNotNull>
						<ifNotNull signDateStart>
						  and J.SIGN_DATE >= #signDateStart#
						</ifNotNull>
						<ifNotNull signDateEnd>
						  and J.SIGN_DATE &lt;= #signDateEnd#
						</ifNotNull>
						<ifNotNull lendDateStart>
						  and J.LEND_DATE >= #lendDateStart#
						</ifNotNull>
						<ifNotNull lendDateEnd>
						  and J.LEND_DATE &lt;= #lendDateEnd#
						</ifNotNull>
					<ifNotNull signlendDate>
					  )
					</ifNotNull>

					<ifNotNull yuCuiOriGrpId>
						AND EXISTS (
							SELECT F.CASE_CODE,F.ORG_ID FROM (SELECT C.CASE_CODE,C.ORG_ID FROM SCTRANS.T_TO_CASE C WHERE C.CASE_CODE = NB.CASE_CODE
							UNION
							SELECT P.CASE_CODE,P.ORG_ID FROM SCTRANS.T_TG_SERV_ITEM_AND_PROCESSOR P WHERE P.CASE_CODE = NB.CASE_CODE ) F
							INNER JOIN SCTRANS.SYS_ORG AS YCORG
							ON F.ORG_ID = YCORG.ID
							WHERE (YCORG.ID = #yuCuiOriGrpId# OR YCORG.PARENT_ID = #yuCuiOriGrpId#) )
					</ifNotNull>
					<ifNotNull isNotResearchCloseCase>
						and NB.CASE_PROPERTY != '30003002'
					</ifNotNull>

					<ifNotNull guohuApproveTimeStart>
						AND t.end_time_ >= #guohuApproveTimeStart#
					</ifNotNull>
					<ifNotNull guohuApproveTimeEnd>
						AND t.end_time_ &lt;= #guohuApproveTimeEnd#
					</ifNotNull>
					<choose>
						<when test	="mortageType==0">
						  and NB.STATUS != '30001001'
					      AND NOT EXISTS (
					     SELECT * FROM sctrans.T_TO_MORTGAGE WHERE IS_ACTIVE = 1 AND CASE_CODE = NB.CASE_CODE
							 )
					     </when>
					     <when test	="mortageType==1">
					      AND EXISTS (
					     SELECT * FROM sctrans.T_TO_MORTGAGE WHERE MORT_TYPE IN ('30016001','30016002') AND IS_ACTIVE = 1 AND IS_DELEGATE_YUCUI = 1 AND CASE_CODE = NB.CASE_CODE
							 )
					     </when>
					     <when test	="mortageType==2">
					       AND EXISTS (
					     SELECT * FROM sctrans.T_TO_MORTGAGE WHERE MORT_TYPE = '30016003' AND IS_ACTIVE = 1 AND IS_DELEGATE_YUCUI = 1 AND CASE_CODE = NB.CASE_CODE
							 )
					     </when>
					     <when test	="mortageType==3">
					       AND EXISTS (
					     SELECT * FROM sctrans.T_TO_MORTGAGE WHERE MORT_TYPE IN ('30016001','30016002') AND IS_ACTIVE = 1 AND IS_DELEGATE_YUCUI = 0 AND CASE_CODE = NB.CASE_CODE
							 )
					     </when>

					</choose>
			) B	where 1=1
						<when test	="isSubscribeFilter==0">
							and B.SUBSCRIBE_COUNT>0
					     </when>
					     <when test	="isSubscribeFilter==1">
							and B.SUBSCRIBE_COUNT=0
					     </when>
				]]>
			</baseSql>
			<orderBySql>
			  ORDER BY B.STATUS_OLD,B.CASE_CODE DESC
			</orderBySql>
			<groupSql>
			</groupSql>
		</searchSql>
		<grid>
			<table-row>
				<column type="both" name="PKID" index="" checkbox="" display="CASEID" customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable="" hide="true"/>
				<column type="both" name="CASE_CODE" index="" checkbox="" display="案件编号" customDict="" sysDict="" format="" width="90" isSort="true" align="" halign="" order="desc" resizable=""/>
				<column type="both" name="PROPERTY_ADDR" index="" checkbox="" display="产证地址" customDict="" sysDict="" format="" width="180" isSort="true" align="" halign="" order="" resizable=""/>
				<column type="both" name="AGENT_NAME" index="" checkbox="" display="经纪人" customDict="" sysDict="" format="" width="60" isSort="true" align="" halign="" order="" resizable=""/>
				<column type="both" name="AGENT_CODE" index="" checkbox="" display="经纪人Id" customDict="" sysDict="" format="" width="60" isSort="true" align="" halign="" order="" resizable=""/>
				<column type="both" name="SUBSCRIBE_COUNT" index="" checkbox="" display="是否关注" customDict="" sysDict="" format="" width="60" isSort="true" align="" halign="" order="" resizable=""/>
				<column type="both" name="CASE_PROPERTY" index="" checkbox="" display="经纪人Id" customDict="" sysDict="" format="" width="60" isSort="true" align="" halign="" order="" resizable=""/>
				<column type="both" name="STATUS_OLD" index="" checkbox="" display="案件状态" customDict="" sysDict="" format=""  width="60" isSort="true" align="" halign="" order="" resizable="" />
				<column type="both" name="RED_COUNT" index="" checkbox="" display="是否红灯" sysDict="" format=""  width="60" isSort="true" align="" halign="" order="" resizable="" />
				<column type="both" name="AGENT_ORG_NAME"  index="" checkbox="" display="所属分行" customDict="" sysDict="" format=""  width="120" isSort="true" align="" halign="" order="" resizable="" />
				<column type="both" name="ctmCode"  index="" checkbox="" display="CTM CODE" sysDict="" format=""  width="120" isSort="true" align="" halign="" order="" resizable="" />
				<column type="both" name="AGENT_PHONE" index="" checkbox="" display="电话" customDict="" sysDict="" format="" width="60" isSort="true" align="" halign="" order="" resizable=""/>
				<column type="both" name="FONT_NAME" index="" checkbox="" display="前台组人员" customDict="" sysDict="" format="" width="60" isSort="true" align="" halign="" order="" resizable=""/>
				
				<column type="virtual" isDynamicDict="true"
					name="FONT_NAME,SELLER,BUYER,PROCESSOR_ID,CASE_PROPERTY_SHOW,STATUS"
					referencecol="CASE_CODE,CASE_PROPERTY,STATUS_OLD" 
					title="前台组人员,上家,下家,经办人,上家,案件状态"
					display="前台组人员,上家,下家,经办人,上家,案件状态"
					customDict="getCaseOverviewInfo" />
			
				<!-- <column type="virtual" name="SELLER" referencecol="CASE_CODE" index="" checkbox="" display="上家" customDict="qqcdSeller" sysDict="" format="" width="60" isSort="true" align="" halign="" order="" resizable="" />
				<column type="virtual" name="BUYER" referencecol="CASE_CODE" index="" checkbox="" display="下家" customDict="qqcdBuyer" sysDict="" format=""  width="60" isSort="true" align="" halign="" order="" resizable="" />
				<column type="virtual" name="PROCESSOR_ID" referencecol="CASE_CODE" index="" checkbox="" display="经办人" customDict="qqcdBackProcessorName" sysDict="" format=""  width="60" isSort="true" align="" halign="" order="" resizable="" />
				<column type="virtual" name="CASE_PROPERTY_SHOW" referencecol="CASE_PROPERTY" index="" checkbox="" display="上家" customDict="qqcdDict30003" sysDict="" format="" width="60" isSort="true" align="" halign="" order="" resizable="" />
				<column type="virtual" name="STATUS" referencecol="STATUS_OLD" index="" checkbox="" display="案件状态" customDict="getStatusNameByCode" sysDict="" format=""  width="60" isSort="true" align="" halign="" order="" resizable="" /> -->
			</table-row>
		</grid>
	</query>
	<query id="queryCastListItemListdiv" cacheCount="true">
		<searchCondition>

		   <condition field="c.CASE_CODE"  name="caseCode" label="案件编号" searchType="LIKE" showType="" showCallback="" defaultValue=""/>
           <condition field="c.PROPERTY_ADDR"  name="propertyAddr" label="物业地址" searchType="LIKE" showType="" showCallback="" defaultValue=""/>
           <condition field="c.sname"  name="sname" label="物业地址" searchType="LIKE" showType="" showCallback="" defaultValue=""/>

          </searchCondition>
		<searchSql>
			<baseSql>
				<![CDATA[

				select * from (
					SELECT
					    B.PKID,
					    B.STATUS AS STATUS_OLD,
					    B.RED_COUNT,
                        B.PROPERTY_ADDR,
                        B.CASE_CODE,
                        B.AGENT_NAME,
                        B.GRP_NAME AGENT_ORG_NAME,
                        (
select stuff((select ',' +a.GUEST_NAME from sctrans.T_TG_GUEST_INFO a where a.CASE_CODE=B.CASE_CODE and a.TRANS_POSITION='30006001'
   for xml path('')),1,1,''))  sname,
                        B.CTM_CODE as ctmCode,B.AGENT_PHONE, B.AGENT_CODE,us.EMPLOYEE_CODE,
                        (SELECT U.REAL_NAME FROM   sctrans.SYS_USER U    inner join  sctrans.T_TO_CASE C on U.ID=C.LEADING_PROCESS_ID AND C.CASE_CODE = B.CASE_CODE)  FONT_NAME

					FROM sctrans.V_CASE_LIST_BASE B
					left join sctrans.SYS_USER us on B.AGENT_CODE=us.ID
					where
					  (  EXISTS ( SELECT 1 FROM SCTRANS.T_TO_CASE C WHERE C.CASE_CODE = B.CASE_CODE
					  )
			    	  OR EXISTS ( SELECT 1 FROM SCTRANS.T_TG_SERV_ITEM_AND_PROCESSOR C WHERE C.CASE_CODE = B.CASE_CODE
			    	  )
			    	  OR EXISTS ( SELECT    1
                      FROM      SCTRANS.T_TG_SERV_ITEM_AND_PROCESSOR A
                                INNER JOIN ( SELECT T.*,S.id
                                             FROM   SCTRANS.T_TL_TASK_REASSIGNT_LOG T
                                                    LEFT JOIN sctrans.SYS_USER S ON t.ORI_ASSIGNEE = S.username
                                           ) L ON L.id = A.PROCESSOR_ID and L.case_code = A.case_code
                                             <ifNotNull userLoginName> AND L.NEW_ASSIGNEE = #userLoginName#</ifNotNull>
                      WHERE     B.CASE_CODE = A.CASE_CODE
                                AND A.SRV_CODE IN ( '3000400201', '3000401002' ) )
			    	  )

			    	) c   where 1=1

				]]>
			</baseSql>
			<orderBySql>
			  ORDER BY c.STATUS_OLD,c.CASE_CODE DESC
			</orderBySql>
			<groupSql>
			</groupSql>
		</searchSql>
		<grid>
			<table-row>
				<column type="both" name="PKID" index="" checkbox="" display="CASEID" customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" order="" resizable="" hide="true"/>
				<column type="both" name="CASE_CODE" index="" checkbox="" display="案件编号" customDict="" sysDict="" format="" width="90" isSort="true" align="" halign="" order="desc" resizable=""/>
				<column type="both" name="PROPERTY_ADDR" index="" checkbox="" display="产证地址" customDict="" sysDict="" format="" width="180" isSort="true" align="" halign="" order="" resizable=""/>
				<column type="both" name="AGENT_NAME" index="" checkbox="" display="经纪人" customDict="" sysDict="" format="" width="60" isSort="true" align="" halign="" order="" resizable=""/>
				<column type="both" name="FONT_NAME" index="" checkbox="" display="前台组人员" customDict="" sysDict="" format="" width="60" isSort="true" align="" halign="" order="" resizable=""/>


				<column type="virtual" name="SELLER" referencecol="CASE_CODE" index="" checkbox="" display="上家" customDict="qqcdSeller" sysDict="" format="" width="60" isSort="true" align="" halign="" order="" resizable="" />
				<column type="virtual" name="BUYER" referencecol="CASE_CODE" index="" checkbox="" display="下家" customDict="qqcdBuyer" sysDict="" format=""  width="60" isSort="true" align="" halign="" order="" resizable="" />
				<column type="virtual" name="PROCESSOR_ID" referencecol="CASE_CODE" index="" checkbox="" display="经办人" customDict="qqcdBackProcessorName" sysDict="" format=""  width="60" isSort="true" align="" halign="" order="" resizable="" />
				<column type="both" name="STATUS_OLD" index="" checkbox="" display="案件状态" customDict="" sysDict="" format=""  width="60" isSort="true" align="" halign="" order="" resizable="" />
				<column type="virtual" name="STATUS" referencecol="STATUS_OLD" index="" checkbox="" display="案件状态" customDict="getStatusNameByCode" sysDict="" format=""  width="60" isSort="true" align="" halign="" order="" resizable="" />
				<column type="both" name="RED_COUNT" index="" checkbox="" display="是否红灯" sysDict="" format=""  width="60" isSort="true" align="" halign="" order="" resizable="" />
				<column type="both" name="AGENT_ORG_NAME"  index="" checkbox="" display="所属分行" customDict="" sysDict="" format=""  width="120" isSort="true" align="" halign="" order="" resizable="" />
				<column type="both" name="ctmCode"  index="" checkbox="" display="CTM CODE" sysDict="" format=""  width="120" isSort="true" align="" halign="" order="" resizable="" />
				<column type="both" name="AGENT_PHONE" index="" checkbox="" display="电话" customDict="" sysDict="" format="" width="60" isSort="true" align="" halign="" order="" resizable=""/>
			    <column type="both" name="AGENT_CODE" index="" checkbox="" display="经纪人Id" customDict="" sysDict="" format="" width="60" isSort="true" align="" halign="" order="" resizable=""/>
			     <column type="both" name="EMPLOYEE_CODE" index="" checkbox="" display="员工编号" customDict="" sysDict="" format="" width="60" isSort="true" align="" halign="" order="" resizable=""/>
			</table-row>
		</grid>
	</query>
	<query id="queryOrgIdListForReportCount" cacheResult="true">
		<searchSql>
			<baseSql>
				<![CDATA[
					SELECT
						ID as orgId,
						ORG_NAME AS orgName,
						(
							SELECT COUNT(CASE_CODE) AS countJDS
								FROM sctrans.T_TO_CASE as t_to_case
									WHERE datediff(year,CREATE_TIME,getdate())=0  and t_to_case.ORG_ID=sys_org.ID
									 <if test="startDate != null">
										 AND   CREATE_TIME &gt;= #startDate#
									 </if>
									 <if test="endDate != null">
										  AND  CREATE_TIME  &lt;= #endDate#
									 </if>
						) as countJDS,
						(
							SELECT COUNT(CASE_CODE) as countQYS
								FROM sctrans.T_TO_CASE as t_to_case
									WHERE  ORG_ID=sys_org.ID and  exists(
										(
											SELECT CASE_CODE FROM sctrans.T_TO_SIGN as t_to_sign
												WHERE PART_CODE is not null
												and t_to_case.CASE_CODE=t_to_sign.CASE_CODE
												and  datediff(year,REAL_CON_TIME,getdate())=0
												<if test="startDate != null">
												 AND t_to_sign.REAL_CON_TIME &gt;= #startDate#
												 </if>
												 <if test="endDate != null">
													  AND t_to_sign.REAL_CON_TIME  &lt;= #endDate#
												 </if>
										)
									)
						) as countQYS,
						(
							SELECT COUNT(CASE_CODE) as countGHS
								FROM sctrans.T_TO_CASE as t_to_case
									WHERE  ORG_ID=sys_org.ID and  exists(
										(
											SELECT CASE_CODE FROM sctrans.T_TO_HOUSE_TRANSFER as t_to_house_transfer
												WHERE
											PART_CODE is not null
											and t_to_case.CASE_CODE=t_to_house_transfer.CASE_CODE
											and  datediff(year,REAL_HT_TIME,getdate())=0
											<if test="startDate != null">
												 AND t_to_house_transfer.REAL_HT_TIME &gt;= #startDate#
											</if>
											<if test="endDate != null">
												  AND t_to_house_transfer.REAL_HT_TIME  &lt;= #endDate#
											</if>
										)
									)
						) as countGHS,
						 (
							SELECT COUNT(CASE_CODE) AS countJAS
							FROM sctrans.T_TO_CASE as t_to_case
							where  datediff(month,Close_Time,getdate())=0
							and t_to_case.ORG_ID=sys_org.ID
							 <if test="startDate != null">
								 AND   CREATE_TIME &gt;= #startDate#
							 </if>
							 <if test="endDate != null">
								  AND  CREATE_TIME  &lt;= #endDate#
							 </if>
						) as countJAS
						FROM sctrans.SYS_ORG  sys_org
						WHERE DEP_HIERARCHY = #depType#
				]]>
			</baseSql>
		</searchSql>
		<grid>
			<table-row>
				<column type="both" name="orgId" index="" checkbox="" display="" customDict="" sysDict=""  width="150" isSort="true" align="" halign="" order="" resizable=""/>
				<column type="both" name="orgName" index="" checkbox="" display="" customDict="" sysDict=""  width="150" isSort="true" align="" halign="" order="" resizable=""/>
				<column type="both" name="countJDS" index="" checkbox="" display="" customDict="" sysDict=""  width="150" isSort="true" align="" halign="" order="" resizable=""/>
				<column type="both" name="countQYS" index="" checkbox="" display="" customDict="" sysDict=""  width="150" isSort="true" align="" halign="" order="" resizable=""/>
				<column type="both" name="countGHS" index="" checkbox="" display="" customDict="" sysDict=""  width="150" isSort="true" align="" halign="" order="" resizable=""/>
				<column type="both" name="countJAS" index="" checkbox="" display="" customDict="" sysDict=""  width="150" isSort="true" align="" halign="" order="" resizable=""/>
			</table-row>
		</grid>
	</query>
	<query id="queryDataCountForDistrict" cacheResult="true">
		<searchSql>
			<baseSql>
				<![CDATA[
				select tn.orgId,tn.orgName,sum(tn.countJDS) as countJDS,sum(tn.countQYS) as countQYS,sum(tn.countGHS) as countGHS,sum(tn.countJAS) as countJAS from(
					SELECT
						parent_id as orgId,
						org_name as orgName,
						(
							SELECT COUNT(CASE_CODE) AS countJDS
								FROM sctrans.T_TO_CASE as t_to_case
									WHERE datediff(year,CREATE_TIME,getdate())=0  and t_to_case.ORG_ID=t1.org_id
									and t_to_case.DISTRICT_ID is not null
										<if test="startDate != null">
											AND   CREATE_TIME &gt;= #startDate#
										</if>
										<if test="endDate != null">
											AND  CREATE_TIME  &lt;= #endDate#
										</if>
						) as countJDS,
						(
							SELECT COUNT(CASE_CODE) as countQYS
								FROM sctrans.T_TO_CASE as t_to_case
									WHERE  ORG_ID=t1.org_id and  exists(
										(
											SELECT CASE_CODE FROM sctrans.T_TO_SIGN as t_to_sign
												WHERE PART_CODE is not null
												and t_to_case.CASE_CODE=t_to_sign.CASE_CODE
												and  datediff(year,REAL_CON_TIME,getdate())=0
												and t_to_case.DISTRICT_ID is not null
												<if test="startDate != null">
													AND t_to_sign.REAL_CON_TIME &gt;= #startDate#
													</if>
													<if test="endDate != null">
														AND t_to_sign.REAL_CON_TIME  &lt;= #endDate#
													</if>
										)
									)
						) as countQYS,
						(
							SELECT COUNT(CASE_CODE) as countGHS
								FROM sctrans.T_TO_CASE as t_to_case
									WHERE  ORG_ID=t1.org_id and  exists(
										(
											SELECT CASE_CODE FROM sctrans.T_TO_HOUSE_TRANSFER as t_to_house_transfer
												WHERE
											PART_CODE is not null
											and t_to_case.CASE_CODE=t_to_house_transfer.CASE_CODE
											and  datediff(year,REAL_HT_TIME,getdate())=0
											and t_to_case.DISTRICT_ID is not null
											<if test="startDate != null">
													AND t_to_house_transfer.REAL_HT_TIME &gt;= #startDate#
											</if>
											<if test="endDate != null">
													AND t_to_house_transfer.REAL_HT_TIME  &lt;= #endDate#
											</if>
										)
									)
						) as countGHS,
							(
							SELECT COUNT(CASE_CODE) AS countJAS
							FROM sctrans.T_TO_CASE as t_to_case
							where  datediff(month,Close_Time,getdate())=0
							and t_to_case.ORG_ID=t1.org_id
							and t_to_case.DISTRICT_ID is not null
								<if test="startDate != null">
									AND   CREATE_TIME &gt;= #startDate#
								</if>
								<if test="endDate != null">
									AND  CREATE_TIME  &lt;= #endDate#
								</if>
						) as countJAS
					FROM
						(
							SELECT
								ID AS org_id,
								PARENT_ID AS parent_id
							FROM
								sctrans.SYS_ORG org_t1
							WHERE
								org_t1.PARENT_ID IN (
									SELECT
										ID AS id
									FROM
										sctrans.SYS_ORG
									WHERE
										DEP_HIERARCHY =  #depType#
									AND IS_DELETED = 0
								)
							AND IS_DELETED = 0
						) t1
					LEFT JOIN (
						SELECT
							ID AS id,
							ORG_NAME AS org_name
						FROM
							sctrans.SYS_ORG
						WHERE
							DEP_HIERARCHY =  #depType#
						AND IS_DELETED = 0) t2 ON t1.PARENT_ID = t2.id
					) as tn group by tn.orgId,tn.orgName
				]]>
			</baseSql>
		</searchSql>
		<grid>
			<table-row>
				<column type="both" name="orgId" index="" checkbox="" display="" customDict="" sysDict=""  width="150" isSort="true" align="" halign="" order="" resizable=""/>
				<column type="both" name="orgName" index="" checkbox="" display="" customDict="" sysDict=""  width="150" isSort="true" align="" halign="" order="" resizable=""/>
				<column type="both" name="countJDS" index="" checkbox="" display="" customDict="" sysDict=""  width="150" isSort="true" align="" halign="" order="" resizable=""/>
				<column type="both" name="countQYS" index="" checkbox="" display="" customDict="" sysDict=""  width="150" isSort="true" align="" halign="" order="" resizable=""/>
				<column type="both" name="countGHS" index="" checkbox="" display="" customDict="" sysDict=""  width="150" isSort="true" align="" halign="" order="" resizable=""/>
				<column type="both" name="countJAS" index="" checkbox="" display="" customDict="" sysDict=""  width="150" isSort="true" align="" halign="" order="" resizable=""/>
			</table-row>
		</grid>
	</query>

	<query id="queryOrgIdListFortRedcountList" cacheResult="true">
		<searchSql>
			<baseSql>
				<![CDATA[
				SELECT
					org_red_count.orgId,
					org_red_count.orgName,
					org_red_count.redCount
					from(
						SELECT
					  	 ID as orgId,
						 ORG_NAME AS orgName,
						 (	 select count(distinct trans_plan.CASE_CODE)
									from
									sctrans.T_TO_TRANS_PLAN trans_plan
									left join
									sctrans.T_TO_CASE t_case
									on trans_plan.CASE_CODE = t_case.CASE_CODE where trans_plan.RED_LOCK=1  and t_case.ORG_ID= sys_org.ID
									) as redCount
									FROM sctrans.SYS_ORG  sys_org
									WHERE DEP_HIERARCHY = #depType#
									) as org_red_count
									where 1=1
									 <if test="strNum != null">
										AND org_red_count.redCount &gt;= #strNum#
									 </if>
									 <if test="endNum != null">
										 AND org_red_count.redCount &lt;= #endNum#
									  </if>
								]]>
			</baseSql>
		</searchSql>
		<grid>
			<table-row>
				<column type="both" name="orgId" index="" checkbox="" display="" customDict="" sysDict=""  width="150" isSort="true" align="" halign="" order="" resizable=""/>
				<column type="both" name="orgName" index="" checkbox="" display="" customDict="" sysDict=""  width="150" isSort="true" align="" halign="" order="" resizable=""/>
				<column type="both" name="redCount" index="" checkbox="" display="" customDict="" sysDict=""  width="150" isSort="true" align="" halign="" order="" resizable=""/>
			</table-row>
		</grid>
	</query>

	<query id="queryCaseReportFormCount" cacheResult="true">
		<searchSql>
			<baseSql>
				<![CDATA[
						select JDS.createTime,
							JDS.countJDS ,
							(
							SELECT QYS.countQYS from
							(SELECT convert(char(7) ,CREATE_TIME , 120) as  createTime,COUNT(CASE_CODE) as countQYS FROM sctrans.T_TO_CASE WHERE CASE_CODE IN((SELECT CASE_CODE FROM   sctrans.T_TO_SIGN	WHERE  PART_CODE is not  null and  datediff(year,CREATE_TIME,getdate())=0 ) )
							 AND  CASE_CODE IN (SELECT CASE_CODE FROM sctrans.T_TG_SERV_ITEM_AND_PROCESSOR WHERE 1=1
										<if test="orgSearchId != null">
											AND  ORG_ID = #orgSearchId#
										</if>
									)  GROUP BY convert(char(7) ,CREATE_TIME , 120)) as QYS where 1=1 and createTime= JDS.createTime) as countQYS,
									(
										select GHS.countGHS from
											(
											SELECT
												convert(char(7) ,CREATE_TIME , 120) as createTime,
												COUNT(CASE_CODE) as countGHS
											 FROM sctrans.T_TO_CASE WHERE CASE_CODE
												 IN((SELECT CASE_CODE  FROM   sctrans.T_TO_HOUSE_TRANSFER	WHERE  datediff(year,CREATE_TIME,getdate())=0))
												 AND  CASE_CODE IN
											  (SELECT CASE_CODE FROM sctrans.T_TG_SERV_ITEM_AND_PROCESSOR
														WHERE 1=1
													<if test="orgSearchId != null" >
														AND ORG_ID = #orgSearchId#
													</if>
											)
											GROUP BY convert(char(7) ,CREATE_TIME , 120)
											) as GHS where GHS.createTime=JDS.createTime
									) as countGHS,
									(
										select JAS.countJAS from (
											SELECT
													CONVERT (CHAR(7), CREATE_TIME, 120) AS createTime,
													COUNT (CASE_CODE) AS countJAS
												FROM
													sctrans.T_TO_CASE
												WHERE
													datediff(MONTH, Close_Time, getdate()) = 0
												AND CASE_CODE IN (
													SELECT
														CASE_CODE
													FROM
														sctrans.T_TG_SERV_ITEM_AND_PROCESSOR
													WHERE
														1 = 1
														<if test="orgSearchId != null" >
														AND ORG_ID = #orgSearchId#
														</if>
												)
												GROUP BY
													CONVERT (CHAR(7), CREATE_TIME, 120)
											) as JAS	where JAS.createTime=JDS.createTime
									)as countJAS
									from
									(SELECT
										a.createTime,
										SUM (countJDS) AS countJDS
									FROM
										(SELECT CONVERT (CHAR(7), CREATE_TIME, 120) AS createTime,COUNT (CASE_CODE) AS countJDS FROM sctrans.T_TO_CASE
											WHERE datediff(YEAR, CREATE_TIME, getdate()) = 0
											AND CASE_CODE IN ((
													SELECT CASE_CODE FROM sctrans.T_TO_CASE
													WHERE 1 = 1
												<if test="orgSearchId != null">
													AND  ORG_ID = #orgSearchId#
												</if>
												)
												UNION(SELECT CASE_CODE FROM sctrans.T_TG_SERV_ITEM_AND_PROCESSOR WHERE 1 = 1
													<if test="orgSearchId != null">
														AND  ORG_ID = #orgSearchId#
													</if>
													))
											GROUP BY CONVERT (CHAR(7), CREATE_TIME, 120)
											UNION ALL SELECT CONVERT (CHAR(7), CREATE_TIME, 120) AS createTime,COUNT (CASE_CODE) AS countJDS FROM sctrans.T_TO_CASE WHERE datediff(MONTH, Close_Time, getdate()) = 0
												AND CASE_CODE IN (SELECT CASE_CODE FROM sctrans.T_TG_SERV_ITEM_AND_PROCESSOR WHERE 1 = 1
													<if test="orgSearchId != null">
														and  org_id = #orgSearchId#
													</if>
												)GROUP BY CONVERT (CHAR(7), CREATE_TIME, 120)) AS a GROUP BY a.createTime) as JDS
						]]>
			</baseSql>
		</searchSql>
		<grid>
			<table-row>
				<column type="both" name="createTime" index="" checkbox="" display="" customDict="" sysDict=""  width="150" isSort="true" align="" halign="" order="" resizable=""/>
				<column type="both" name="countJDS" index="" checkbox="" display="" customDict="" sysDict=""  width="150" isSort="true" align="" halign="" order="" resizable=""/>
				<column type="both" name="countQYS" index="" checkbox="" display="" customDict="" sysDict=""  width="150" isSort="true" align="" halign="" order="" resizable=""/>
				<column type="both" name="countGHS" index="" checkbox="" display="" customDict="" sysDict=""  width="150" isSort="true" align="" halign="" order="" resizable=""/>
				<column type="both" name="countJAS" index="" checkbox="" display="" customDict="" sysDict=""  width="150" isSort="true" align="" halign="" order="" resizable=""/>
			</table-row>
		</grid>
	</query>

	<query id="queryRedcountListForPeople" cacheResult="true">
		<searchSql>
			<baseSql>
				<![CDATA[
				select redCount.processorId,redCount.redLightCount from
					(select t_to_case.LEADING_PROCESS_ID as processorId,count(trans_plan.CASE_CODE) as redLightCount
						from
						sctrans.T_TO_TRANS_PLAN trans_plan
						left join
						sctrans.T_TO_CASE t_to_case
						on trans_plan.CASE_CODE = t_to_case.CASE_CODE where trans_plan.RED_LOCK=1  and t_to_case.LEADING_PROCESS_ID IN
						(#teamUserIds#) group by t_to_case.LEADING_PROCESS_ID ) redCount where 1=1
						 <if test="strNum != null">
							AND redCount.redLightCount &gt;= #strNum#
						 </if>
						 <if test="endNum != null">
							 AND redCount.redLightCount &lt;= #endNum#
						  </if>
				]]>
			</baseSql>
		</searchSql>
		<grid>
			<table-row>
				<column type="both" name="processorId" index="" checkbox="" display="" customDict="" sysDict=""  width="150" isSort="true" align="" halign="" order="" resizable=""/>
				<column type="both" name="redLightCount" index="" checkbox="" display="" customDict="" sysDict=""  width="150" isSort="true" align="" halign="" order="" resizable=""/>

			</table-row>
		</grid>
	</query>
	<query id="queryJdsCountDataForTradeDirector" cacheResult="true">
		<searchSql>
			<baseSql>
				<![CDATA[
						select COUNT(dateCount.CASE_CODE)  as dateCount,dateCount.processor from (
							select CASE_CODE,LEADING_PROCESS_ID as processor
								 from sctrans.T_TO_CASE
									WHERE 1=1
									AND LEADING_PROCESS_ID IN
									(#teamUserIds#)
									 <if test="startDate != null">
										 AND   CREATE_TIME &gt;= #startDate#
									 </if>
									 <if test="endDate != null">
										  AND  CREATE_TIME  &lt;= #endDate#
									 </if>
									Union
									SELECT CASE_CODE,PROCESSOR_ID as p1 FROM sctrans.T_TG_SERV_ITEM_AND_PROCESSOR as t_tg_serv_item_and_processor
										WHERE 1=1
										AND  t_tg_serv_item_and_processor.PROCESSOR_ID IN
										(#teamUserIds#)
										 <if test="startDate != null">
											 AND   CREATE_TIME &gt;= #startDate#
										 </if>
										 <if test="endDate != null">
											  AND  CREATE_TIME  &lt;= #endDate#
										 </if>
							) as dateCount group by processor
				]]>
			</baseSql>
		</searchSql>
		<grid>
			<table-row>
				<column type="both" name="dateCount" index="" checkbox="" display="" customDict="" sysDict=""  width="150" isSort="true" align="" halign="" order="" resizable=""/>
				<column type="both" name="processor" index="" checkbox="" display="" customDict="" sysDict=""  width="150" isSort="true" align="" halign="" order="" resizable=""/>
			</table-row>
		</grid>
	</query>

	<query id="queryCountDataForCountForm" cacheResult="true">
		<searchSql>
			<baseSql>
				<![CDATA[
				(select
						count(CASE_CODE) as DATA_COUNT ,
						'JDS' as TYPE,
						LEADING_PROCESS_ID as PROCESSOR
							 from
					    sctrans.T_TO_CASE t_to_case
					 		 where
					 	t_to_case.ORG_ID=#paraOrgId#
 						<if test="startDate != null">
							 AND t_to_case.CREATE_TIME &gt;= #startDate#
						 </if>
						 <if test="endDate != null">
							  AND t_to_case.CREATE_TIME  &lt;= #endDate#
						 </if>

					     group by t_to_case.LEADING_PROCESS_ID
					 )
					  union all
					(
					select
					 	count(CASE_CODE) as DATA_COUNT ,
					 	'QYS' as TYPE,
					 	PROCESSOR_ID as PROCESSOR
					 		from
					 	sctrans.T_TG_SERV_ITEM_AND_PROCESSOR as t_tg_serv_item_and_processor
					 		where
					 	t_tg_serv_item_and_processor.ORG_ID=#paraOrgId#
					 		AND
					 	exists(
					 		select
					 		 t_to_sign.CASE_CODE
					 		 	from
					 		 sctrans.T_TO_SIGN t_to_sign
					 			 where
					 		 IS_ACTIVE = 1
					 		 and t_tg_serv_item_and_processor.CASE_CODE = t_to_sign.CASE_CODE
					 		  <if test="startDate != null">
								 AND t_to_sign.REAL_CON_TIME &gt;= #startDate#
							 </if>
							 <if test="endDate != null">
								  AND t_to_sign.REAL_CON_TIME  &lt;= #endDate#
							 </if>
					 		 ) group by t_tg_serv_item_and_processor.PROCESSOR_ID)
					 		  union all
					(
				    select
						count(CASE_CODE) as DATA_COUNT ,
						'GHS' as TYPE,
						PROCESSOR_ID as PROCESSOR
							from
						sctrans.T_TG_SERV_ITEM_AND_PROCESSOR t_tg_serv_item_and_processor
							where
							t_tg_serv_item_and_processor.ORG_ID=#paraOrgId#
						AND exists(
						select
							t_to_house_transfer.CASE_CODE
						from
						sctrans.T_TO_HOUSE_TRANSFER t_to_house_transfer
						where
						t_to_house_transfer.IS_ACTIVE = 1
						and  t_tg_serv_item_and_processor.CASE_CODE = t_to_house_transfer.CASE_CODE
						 <if test="startDate != null">
							 AND t_to_house_transfer.REAL_HT_TIME &gt;= #startDate#
						 </if>
						 <if test="endDate != null">
							  AND t_to_house_transfer.REAL_HT_TIME  &lt;= #endDate#
						 </if>
						)
						group by t_tg_serv_item_and_processor.PROCESSOR_ID
						)
					 union all
					(
						select
						count(CASE_CODE) as DATA_COUNT,
						'JAS' as TYPE,
						LEADING_PROCESS_ID as PROCESSOR
							from
						sctrans.T_TO_CASE t_to_case
							where
						t_to_case.ORG_ID=#paraOrgId#
						 <if test="startDate != null">
							 AND ClOSE_TIME &gt;= #startDate#
						 </if>
						 <if test="endDate != null">
							  AND ClOSE_TIME  &lt;= #endDate#
						 </if>
						group by t_to_case.LEADING_PROCESS_ID
					)
				]]>
			</baseSql>
		</searchSql>
		<grid>
			<table-row>
				<column type="both" name="DATA_COUNT" index="" checkbox="" display="" customDict="" sysDict=""  width="150" isSort="true" align="" halign="" order="" resizable=""/>
				<column type="both" name="TYPE" index="" checkbox="" display="" customDict="" sysDict=""  width="150" isSort="true" align="" halign="" order="" resizable=""/>
				<column type="both" name="PROCESSOR" index="" checkbox="" display="" customDict="" sysDict=""  width="150" isSort="true" align="" halign="" order="" resizable=""/>
			</table-row>
		</grid>
	</query>

	<query id="queryFormJds" cacheResult="true">
		<searchSql>
			<baseSql>
				<![CDATA[
					SELECT CONVERT (CHAR(7), CREATE_TIME, 120) AS createTime,
						COUNT (CASE_CODE) AS countJDS FROM sctrans.T_TO_CASE as t_to_case
						WHERE datediff(YEAR, CREATE_TIME, getdate()) = 0
						<if test="orgSearchId != null">
							AND  t_to_case.ORG_ID = #orgSearchId#
						</if>
						<if test="districtSearchId != null">
							AND  t_to_case.DISTRICT_ID = #districtSearchId#
						</if>
					GROUP BY CONVERT (CHAR(7), t_to_case.CREATE_TIME, 120)
				]]>
			</baseSql>
		</searchSql>
		<grid>
			<table-row>
				<column type="both" name="createTime" index="" checkbox="" display="" customDict="" sysDict=""  width="150" isSort="true" align="" halign="" order="" resizable=""/>
				<column type="both" name="countJDS" index="" checkbox="" display="" customDict="" sysDict=""  width="150" isSort="true" align="" halign="" order="" resizable=""/>
			</table-row>
		</grid>
	</query>


	<query id="queryFormJas" cacheResult="true">
		<searchSql>
			<baseSql>
				<![CDATA[
					SELECT CONVERT (CHAR(7), CLOSE_TIME, 120) AS createTime,
						COUNT (CASE_CODE) AS countJAS FROM sctrans.T_TO_CASE as t_to_case
						WHERE datediff(YEAR, CLOSE_TIME, getdate()) = 0
						<if test="orgSearchId != null">
							AND  t_to_case.ORG_ID = #orgSearchId#
						</if>
							<if test="districtSearchId != null">
							AND  t_to_case.DISTRICT_ID = #districtSearchId#
						</if>
					GROUP BY CONVERT (CHAR(7), t_to_case.CLOSE_TIME, 120)
				]]>
			</baseSql>
		</searchSql>
		<grid>
			<table-row>
				<column type="both" name="createTime" index="" checkbox="" display="" customDict="" sysDict=""  width="150" isSort="true" align="" halign="" order="" resizable=""/>
				<column type="both" name="countJAS" index="" checkbox="" display="" customDict="" sysDict=""  width="150" isSort="true" align="" halign="" order="" resizable=""/>
			</table-row>
		</grid>
	</query>

	<query id="queryFormQys" cacheResult="true">
		<searchSql>
			<baseSql>
				<![CDATA[
					select
						CONVERT (CHAR(7), t_to_sign.REAL_CON_TIME, 120) AS createTime,
						COUNT (t_to_sign.CASE_CODE) AS countQYS
						from
					 sctrans.T_TO_SIGN as t_to_sign left join sctrans.T_TO_CASE as t_to_case on t_to_sign.CASE_CODE=t_to_case.CASE_CODE
						where
						datediff(YEAR, t_to_sign.REAL_CON_TIME, getdate()) = 0
						<if test="orgSearchId != null">
							AND  t_to_case.ORG_ID = #orgSearchId#
						</if>
							<if test="districtSearchId != null">
							AND  t_to_case.DISTRICT_ID = #districtSearchId#
						</if>

					GROUP BY CONVERT (CHAR(7), t_to_sign.REAL_CON_TIME, 120)
				]]>
			</baseSql>
		</searchSql>
		<grid>
			<table-row>
				<column type="both" name="createTime" index="" checkbox="" display="" customDict="" sysDict=""  width="150" isSort="true" align="" halign="" order="" resizable=""/>
				<column type="both" name="countQys" index="" checkbox="" display="" customDict="" sysDict=""  width="150" isSort="true" align="" halign="" order="" resizable=""/>
			</table-row>
		</grid>
	</query>

	<query id="queryFormGhs" cacheResult="true">
		<searchSql>
			<baseSql>
				<![CDATA[
					  select
						CONVERT (CHAR(7), t_to_house_transfer.REAL_HT_TIME, 120) AS createTime,
						COUNT (t_to_house_transfer.CASE_CODE) AS countGHS
						from
							 sctrans.T_TO_HOUSE_TRANSFER as t_to_house_transfer left join sctrans.T_TO_CASE as t_to_case on t_to_house_transfer.CASE_CODE=t_to_case.CASE_CODE
						where
						datediff(YEAR, t_to_house_transfer.REAL_HT_TIME, getdate()) = 0
						<if test="orgSearchId != null">
							AND  t_to_case.ORG_ID = #orgSearchId#
						</if>
						<if test="districtSearchId != null">
							AND  t_to_case.DISTRICT_ID = #districtSearchId#
						</if>


					GROUP BY CONVERT (CHAR(7), t_to_house_transfer.REAL_HT_TIME, 120)
				]]>
			</baseSql>
		</searchSql>
		<grid>
			<table-row>
				<column type="both" name="createTime" index="" checkbox="" display="" customDict="" sysDict=""  width="150" isSort="true" align="" halign="" order="" resizable=""/>
				<column type="both" name="countGHS" index="" checkbox="" display="" customDict="" sysDict=""  width="150" isSort="true" align="" halign="" order="" resizable=""/>
			</table-row>
		</grid>
	</query>
	<query id="queryCountForAllRedLock" cacheResult="true">
		<searchSql>
			<baseSql>
				<![CDATA[
					SELECT
						org.org_name,
						ISNULL(district_case.ROW_COUNT,0) redCount
					FROM
						(
							SELECT
								DISTRICT_ID,
								count(DISTRICT_ID) ROW_COUNT
							FROM
								sctrans.T_TO_CASE case1 left join sctrans.T_TO_TRANS_PLAN trans_plan on case1.CASE_CODE=trans_plan.CASE_CODE
							WHERE
								DISTRICT_ID IS NOT NULL and trans_plan.RED_LOCK=1
							GROUP BY
								DISTRICT_ID
						) AS district_case
					right JOIN sctrans.sys_org org ON district_case.DISTRICT_ID = org.id where org.DEP_HIERARCHY = 'yucui_district' and org.IS_DELETED=0
						 <if test="strNum != null">
							AND district_case.ROW_COUNT &gt;= #strNum#
						 </if>
						 <if test="endNum != null">
							 AND district_case.ROW_COUNT &lt;= #endNum#
						  </if>
					ORDER BY
						district_case.ROW_COUNT DESC

				]]>
			</baseSql>
		</searchSql>
		<grid>
			<table-row>
				<column type="both" name="org_name" index="" checkbox="" display="" customDict="" sysDict=""  width="150" isSort="true" align="" halign="" order="" resizable=""/>
				<column type="both" name="redCount" index="" checkbox="" display="" customDict="" sysDict=""  width="150" isSort="true" align="" halign="" order="" resizable=""/>
			</table-row>
		</grid>
	</query>

</querys>
