<?xml version="1.0" encoding="UTF-8"?><querys>
	<dicts>
		<customDict id="qqcdMortName" beanName="qqcdMortName"></customDict>
		<customDict id="qqPropertyAddr" beanName="qqPropertyAddr"></customDict>
		<customDict id="qqFinOrgNameYC" beanName="qqFinOrgNameYC"></customDict>
		<customDict id="qqFenHang" beanName="qqFenHang"></customDict>
		<customDict id="qqcdOrgIdName" beanName="qqcdOrgIdName"></customDict>
		<customDict id="qqFenHang" beanName="qqFenHang"></customDict>
		<customDict id="qqRealName" beanName="qqRealName"></customDict>
		<customDict id="qqIsLost" beanName="qqIsLost"></customDict>
	
		<customDict id="qqSignPrice" beanName="qqSignPrice"></customDict>
		<customDict id="qqEvalFee" beanName="qqEvalFee"></customDict>
		<customDict id="qqCaseProperty" beanName="qqCaseProperty"></customDict>
		<customDict id="qqMortgageAmount" beanName="qqMortgageAmount"></customDict>
		<customDict id="qqcdMortServName" beanName="qqcdMortServName"></customDict>


	</dicts>

	<formatters>
		
		<formatter id="dateFormatter" ref="" class="com.aist.common.quickQuery.formatter.DateFormatter" />
		<formatter id="numberFormater" ref="" class="com.aist.common.quickQuery.formatter.NumberFormatter">
			<properties>
				<property name="groupingUsed">true</property>
				<property name="maximumFractionDigits">3</property>
				<property name="maximumIntegerDigits">40</property>
				<property name="minimumFractionDigits">0</property>
				<property name="minimumIntegerDigits">1</property>
			</properties>
		</formatter>
		<formatter id="integerFormater" ref="" class="com.aist.common.quickQuery.formatter.NumberFormatter">
			<properties>
				<property name="maximumFractionDigits">0</property>
			</properties>
		</formatter>
	</formatters>
	
	<query id="findToMortgage4Par">
	    <searchCondition>      
        </searchCondition> 
		<searchSql>
			<baseSql>
				<![CDATA[
					SELECT 
							(SELECT ID_ FROM sctrans.ACT_RU_TASK WHERE PROC_INST_ID_ = (SELECT INST_CODE FROM sctrans.T_TO_WORKFLOW WHERE BIZ_CODE = m.MORT_PKID AND BUSINESS_KEY = 'Loaner_Process')) AS taskId,
							(SELECT PROC_INST_ID_ FROM sctrans.ACT_RU_TASK WHERE PROC_INST_ID_ = (SELECT INST_CODE FROM sctrans.T_TO_WORKFLOW WHERE BIZ_CODE = m.MORT_PKID AND BUSINESS_KEY = 'Loaner_Process')) AS taskId,
							ISNULL(m.SEND_ID,'') as consultantID,
							ISNULL(m.CUST_NAME,'') as custName,
							ISNULL((SELECT NAME FROM sctrans.SYS_DICT WHERE CODE = m.LOANER_STATUS AND IS_DELETED = 0 AND AVAILABLE = 1 AND TAG = 'MORT'),'派单') AS loanerStatus,
							ISNULL((SELECT NAME FROM sctrans.SYS_DICT WHERE CODE = m.FLOW_STATUS AND IS_DELETED = 0 AND AVAILABLE = 1),'') AS flowStatus,
							ISNULL(m.MORT_TOTAL_AMOUNT,0.00) as loanAmount,
							CAST(ISNULL(m.COM_YEAR,0) as varchar)+'年' as loanTime,
							ISNULL(CONVERT(varchar(100), m.SEND_TIME, 23),'') as applyTime,
							'MORT' as prdType,
							m.CASE_CODE as caseCode,
							CAST(m.MORT_PKID as varchar)	as bizCode,
							ISNULL(p.PROPERTY_ADDR,'') 	as addr,
							ISNULL(uoj.employee_code,'') 	as avartaUrl,
							ISNULL(uoj.real_name,'') 		as consultantName
					FROM sctrans.T_TO_MORT_LOANER m
					LEFT JOIN sctrans.T_TO_PROPERTY_INFO p ON p.CASE_CODE = m.CASE_CODE AND m.LOANER_ID = #userid#
					LEFT JOIN sctrans.V_USER_ORG_JOB uoj ON m.LOANER_ID = uoj.user_id AND uoj.ismain = 1
					WHERE m.LOANER_ID = #userid# 
					AND EXISTS (select 1 from sctrans.T_TO_CASE c where c.CASE_CODE = m.CASE_CODE and c.LOAN_REQ=1)
				
				<if test="flag == 'noAccept'">
					AND (m.LOANER_STATUS = '' or m.LOANER_STATUS IS NULL)
				</if>
				
				<if test="flag == 'exceptNoAccept'">
					AND (m.LOANER_STATUS != '' and m.LOANER_STATUS IS NOT NULL)
				</if>
				
				<ifNotNull q_text>
					 AND (m.CUST_NAME LIKE '%'+#q_text#+'%'
					     			OR p.PROPERTY_ADDR	LIKE '%'+#q_text#+'%'
					     			OR uoj.real_name LIKE '%'+#q_text#+'%')
				</ifNotNull>		
				]]>
			</baseSql>
			<groupSql>
			</groupSql>
			<orderBySql>
			  ORDER BY m.SEND_TIME
			   DESC
			</orderBySql>
		</searchSql>
		<grid>
			<table-row>
				<column  name="taskId" title="任务id" index=""  default="" checkbox=""  customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" resizable="" />
				<column  name="procInstanceId" title="流程实例id" index=""  default="" checkbox=""  customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" resizable="" />
				<column  name="avartaUrl"   title="交易顾问头像地址"  index="" default="" checkbox=""  customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" resizable="" />
				<column  name="consultantID"   title="交易顾问id"  index="" default="" checkbox=""  customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" resizable="" />
				<column  name="consultantName"   title="交易顾问名称"  index="" default="" checkbox=""  customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" resizable="" />
				<column  name="custName"   title="客户名称"  index="" default="" checkbox=""  customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" resizable="" />
				<column  name="loanerStatus"   title="派单状态"  index="" default="" checkbox=""  customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" resizable="" />
				<column  name="flowStatus"   title="跟进状态"  index="" default="" checkbox=""  customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" resizable="" />
				<column  name="loanAmount"   title="贷款金额"  index="" default="" checkbox=""  customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" resizable="" />
				<column  name="loanTime"   title="贷款期数"  index="" default="" checkbox=""  customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" resizable="" />
				<column  name="addr"   title="产证地址"  index="" default="" checkbox=""  customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" resizable="" />
				<column  name="applyTime"   title="申请时间"  index="" default="" checkbox=""  customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" resizable="" />
				<column  name="prdType"   title="产品类型"  index="" default="" checkbox=""  customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" resizable="" />
				<column  name="caseCode"   title="案件编号"  index="" default="" checkbox=""  customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" resizable="" />
				<column  name="bizCode"   title="E+金融编号"  index="" default="" checkbox=""  customDict="" sysDict="" format="" width="0" isSort="" align="" halign="" resizable="" />
			</table-row>
		</grid>
	</query>
</querys>